const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Alert-1.0.43-BeyiDeYu.js","./cm-1.0.43-BIThoEwM.js","./redux-1.0.43-X9ShETON.js","./vendor-1.0.43-CN03Eozo.js","./index-1.0.43-Lwi8RVeB.js","./iconBase-1.0.43-BkINToSh.js","./Typography-1.0.43-CjHjtdZs.js","./lib-1.0.43-GM4CAPbj.js","./loglevel-1.0.43-BZ7XahX3.js","./lodash-1.0.43-BGoSrRk7.js","./moment-1.0.43-C5S46NFB.js","./useEnhancedEffect-1.0.43-DcXwKdLb.js","./AlertTitle-1.0.43-CmdM_nv2.js","./createSvgIcon-1.0.43-C8_lU5Lv.js","./Close-1.0.43-DZEA4jNx.js"])))=>i.map(i=>d[i]);
import{_ as se}from"./main-1.0.43.js";import{z as Ye,j as e,_ as N}from"./cm-1.0.43-BIThoEwM.js";import{r as a}from"./redux-1.0.43-X9ShETON.js";import{a as us,b as xs,c as ms,d as gs,e as Ht,f as hs,g as fs,h as js,l as Gt}from"./ActionsExplorer-1.0.43-BvdT5anO.js";import{a as J,u as Qe}from"./hooks-1.0.43-Bzf6s8gj.js";import{l as d,a as Z,as as bs,at as ys,au as Ss,av as Cs,aw as Ts,ax as Is,ay as st,az as vs,m as Te,aA as ws,aB as Es,aC as ks,aD as nt,aE as at,aF as qt,aG as Yt,aH as Ut,aI as Jt,aJ as Ps,aK as _s,C as dt,ae as As,aL as Ms,aM as Ds,aN as Ls}from"./lib-1.0.43-GM4CAPbj.js";import{B as l,S as Os}from"./Spinner-1.0.43-YmZqinVQ.js";import{c as Qt,j as Et,l as Rs,n as Xt,o as rt,f as zs,T as Me}from"./Typography-1.0.43-CjHjtdZs.js";import{u as De,M as Le,B as Rt}from"./index.esm-1.0.43-B1V1l_dh.js";import{T as xe,u as kt,a as Bs,b as Fs,c as Ns}from"./ActionsAdmin-1.0.43-B7E4Per7.js";import{g as Zt,h as es,i as ts,e as Ks}from"./index-1.0.43-Lwi8RVeB.js";import{O as it,P as Vs,Q as Ws,e as $s,m as Hs,R as Gs,n as qs,A as ss,T as ns,S as Ys,U as Us,V as as,W as rs,M as is,X as Js,Y as Qs,Z as Xs,k as Zs,x as zt,_ as en,t as tn,u as sn,v as nn,i as an}from"./index-1.0.43-Br_nYvvF.js";import{b as rn,c as on}from"./index-1.0.43-CEsXajp3.js";import{u as os,h as St,a as Ct,T as ln,b as cn,c as dn,d as pn,e as un,f as xn,g as mn,i as gn,j as hn,k as Bt,t as ie,S as fn}from"./TreeItem2Provider-1.0.43-C2Ft9Foa.js";import{C as pe}from"./Checkbox-1.0.43-C_H-ygma.js";import{a as Ft,e as Nt,r as Ee,I as le,P as ut}from"./iconBase-1.0.43-BkINToSh.js";import{C as jn}from"./Collapse-1.0.43-CtSvLI94.js";import{E as ot}from"./ExplorerActionEnum-1.0.43-eclZgKpy.js";import{A as Ce}from"./AdminTheme-1.0.43-CqjS-p3h.js";import{u as bn}from"./index-1.0.43-C6_8mZyP.js";import{T as Ue}from"./Tooltip-1.0.43-Dw3sfo8K.js";import{L as ke}from"./Link-1.0.43-CsQWhuI0.js";import{D as G}from"./DatabaseTypeEnum-1.0.43-DeJfpW1u.js";import{u as mt}from"./useExplorer-1.0.43-XZ_Um4lj.js";import{C as yn,a as Sn}from"./CardContent-1.0.43-B1eq8QmP.js";import{C as Cn}from"./CardHeader-1.0.43-Cj6GRAA3.js";import{F as te,a as lt}from"./FormHelperText-1.0.43-BbvxPfFT.js";import{F as ct}from"./FormLabel-1.0.43-DuYrsDLO.js";import{C as Tn}from"./CardActions-1.0.43-CprgiBCD.js";import{B as _e,C as Pt}from"./ConfirmDialog-1.0.43-HyVPTU5U.js";import{T as Se,I as vt}from"./TextField-1.0.43-DsZQBbKY.js";import{I as Kt}from"./InputAdornment-1.0.43-9P5bF1dN.js";import{A as wt}from"./AlertDialog-1.0.43-Der7jh53.js";import{S as xt}from"./Select-1.0.43-CISjJoqC.js";import{M as ue}from"./MenuItem-1.0.43-Uicrp-o6.js";import{T as _t,b as Ae,c as A,a as At}from"./TableRow-1.0.43-PHyz2C67.js";import{T as Mt}from"./TableHead-1.0.43-DimterWj.js";import{T as pt}from"./Tooltip-1.0.43-dEMLW8-v.js";import{e as oe}from"./notistack-1.0.43-CFZ1B9cW.js";/* empty css                    */import{d as Tt}from"./dayjs.min-1.0.43-B1axidXt.js";import{a as It}from"./RestApi-1.0.43-DDknciaN.js";import{u as In}from"./useScreenSize-1.0.43-BkaemLwA.js";import{N as vn}from"./react-number-format.es-1.0.43-Dn0EVwh2.js";import{A as Vt}from"./Autocomplete-1.0.43-C-3GGJwT.js";import{L as wn}from"./useMobilePicker-1.0.43-wKjIFMVp.js";import{A as En}from"./AdapterDayjs-1.0.43-paeIPXvc.js";import{D as kn}from"./DateTimePicker-1.0.43-MatMNCyw.js";import"./vendor-1.0.43-CN03Eozo.js";import"./loglevel-1.0.43-BZ7XahX3.js";import"./lodash-1.0.43-BGoSrRk7.js";import"./moment-1.0.43-C5S46NFB.js";import"./createSvgIcon-1.0.43-C8_lU5Lv.js";import"./Stack-1.0.43-Bz9AkBaK.js";import"./useThemeProps-1.0.43-C5lTKcwO.js";import"./getThemeProps-1.0.43-5uxEwZ_e.js";import"./Radio-1.0.43-GAuAP3gY.js";import"./SwitchBase-1.0.43-jxlYBoq8.js";import"./useFormControl-1.0.43-D7bmEJOO.js";import"./useControlled-1.0.43-DObA-A1B.js";import"./Menu-1.0.43-TbmZ3Ge2.js";import"./ThemeProvider-1.0.43-BdkGbeAu.js";import"./useEnhancedEffect-1.0.43-DcXwKdLb.js";import"./Chip-1.0.43-Ci13k7gB.js";import"./AlertTitle-1.0.43-CmdM_nv2.js";import"./Close-1.0.43-DZEA4jNx.js";import"./ListItemIcon-1.0.43-BCRBmmI9.js";import"./Divider-1.0.43-BNePHRrN.js";import"./FormControlLabel-1.0.43-DhLqIzQC.js";import"./Switch-1.0.43-DUXi6nEm.js";import"./Slider-1.0.43-DwDICOHK.js";import"./visuallyHidden-1.0.43-Dan1xhjv.js";import"./TimePicker-1.0.43-ykLKdyjf.js";import"./index-1.0.43-DTrIm2Pv.js";import"./timeViewRenderers-1.0.43-BWypgxuk.js";import"./DatePicker-1.0.43-12Z9ZRmK.js";import"./dateViewRenderers-1.0.43-X8xYeo7E.js";import"./Popper-1.0.43-8Yb3KIgh.js";import"./utils-1.0.43-iop7lDec.js";import"./lang-1.0.43-B1WmIuB6.js";import"./ListItem-1.0.43-Bg1FR-64.js";import"./Tabs-1.0.43-C3a4iH_4.js";function ls(t){const{instance:s,items:{onItemClick:r},selection:{multiSelect:i,checkboxSelection:c,disableSelection:u},expansion:{expansionTrigger:y}}=os(),j=s.isItemExpandable(t),C=s.isItemExpanded(t),x=s.isItemFocused(t),b=s.isItemSelected(t),p=s.isItemDisabled(t),g=s!=null&&s.isItemBeingEdited?s==null?void 0:s.isItemBeingEdited(t):!1,K=s.isItemEditable?s.isItemEditable(t):!1,z=f=>{if(!p){x||s.focusItem(f,t);const O=i&&(f.shiftKey||f.ctrlKey||f.metaKey);j&&!(O&&s.isItemExpanded(t))&&s.toggleItemExpansion(f,t)}},v=f=>{p||(x||s.focusItem(f,t),i&&(f.shiftKey||f.ctrlKey||f.metaKey)?f.shiftKey?s.expandSelectionRange(f,t):s.selectItem({event:f,itemId:t,keepExistingSelection:!0}):s.selectItem({event:f,itemId:t,shouldBeSelected:!0}))},w=f=>{if(u||p)return;const O=f.nativeEvent.shiftKey;i&&O?s.expandSelectionRange(f,t):s.selectItem({event:f,itemId:t,keepExistingSelection:i,shouldBeSelected:f.target.checked})},V=f=>{(f.shiftKey||f.ctrlKey||f.metaKey||p)&&f.preventDefault()},B=()=>{St(s,Ct)&&s.isItemEditable(t)&&(s.isItemBeingEdited(t)?s.setEditedItemId(null):s.setEditedItemId(t))};return{disabled:p,expanded:C,selected:b,focused:x,editable:K,editing:g,disableSelection:u,checkboxSelection:c,handleExpansion:z,handleSelection:v,handleCheckboxSelection:w,handleContentClick:r,preventSelection:V,expansionTrigger:y,toggleItemEditing:B,handleSaveItemLabel:(f,O)=>{St(s,Ct)&&s.isItemBeingEditedRef(t)&&(s.updateItemLabel(t,O),B(),s.focusItem(f,t))},handleCancelItemLabelEditing:f=>{St(s,Ct)&&s.isItemBeingEditedRef(t)&&(B(),s.focusItem(f,t))}}}const Pn=["classes","className","displayIcon","expansionIcon","icon","label","itemId","onClick","onMouseDown","dragAndDropOverlayProps","labelInputProps"],cs=a.forwardRef(function(s,r){const{classes:i,className:c,displayIcon:u,expansionIcon:y,icon:j,label:C,itemId:x,onClick:b,onMouseDown:p,dragAndDropOverlayProps:g,labelInputProps:K}=s,z=Ye(s,Pn),{disabled:v,expanded:w,selected:V,focused:B,editing:P,editable:q,disableSelection:f,checkboxSelection:O,handleExpansion:k,handleSelection:D,handleCheckboxSelection:R,handleContentClick:S,preventSelection:T,expansionTrigger:o,toggleItemEditing:m}=ls(x),h=j||y||u,M=a.useRef(null),F=E=>{T(E),p&&p(E)},H=E=>{var U;S==null||S(E,x),!((U=M.current)!=null&&U.contains(E.target))&&(o==="content"&&k(E),O||D(E),b&&b(E))},W=E=>{E.defaultMuiPrevented||m()};return e.jsxs("div",N({},z,{className:Qt(i.root,c,w&&i.expanded,V&&i.selected,B&&i.focused,v&&i.disabled,P&&i.editing,q&&i.editable),onClick:H,onMouseDown:F,ref:r,children:[e.jsx("div",{className:i.iconContainer,children:h}),O&&e.jsx(pe,{className:i.checkbox,checked:V,onChange:R,disabled:v||f,ref:M,tabIndex:-1}),P?e.jsx(ln,N({},K,{className:i.labelInput})):e.jsx("div",N({className:i.label},q&&{onDoubleClick:W},{children:C})),g&&e.jsx(cn,N({},g))]}))}),_n=["children","className","slots","slotProps","ContentComponent","ContentProps","itemId","id","label","onClick","onMouseDown","onFocus","onBlur","onKeyDown"],An=["ownerState"],Mn=["ownerState"],Dn=["ownerState"],Ln=pn(),On=t=>{const{classes:s}=t;return Rs({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],checkbox:["checkbox"],label:["label"],labelInput:["labelInput"],editing:["editing"],editable:["editable"],groupTransition:["groupTransition"]},hn,s)},Rn=Et("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:(t,s)=>s.root})({listStyle:"none",margin:0,padding:0,outline:0}),zn=Et(cs,{name:"MuiTreeItem",slot:"Content",overridesResolver:(t,s)=>[s.content,s.iconContainer&&{[`& .${ie.iconContainer}`]:s.iconContainer},s.label&&{[`& .${ie.label}`]:s.label}],shouldForwardProp:t=>Xt(t)&&t!=="indentationAtItemLevel"})(({theme:t})=>({padding:t.spacing(.5,1),borderRadius:t.shape.borderRadius,width:"100%",boxSizing:"border-box",position:"relative",display:"flex",alignItems:"center",gap:t.spacing(1),cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${ie.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,backgroundColor:"transparent"},[`&.${ie.focused}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${ie.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:rt(t.palette.primary.main,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:rt(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:rt(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${ie.focused}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:rt(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`& .${ie.iconContainer}`]:{width:16,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},[`& .${ie.label}`]:N({width:"100%",boxSizing:"border-box",minWidth:0,position:"relative"},t.typography.body1),[`& .${ie.checkbox}`]:{padding:0},variants:[{props:{indentationAtItemLevel:!0},style:{paddingLeft:`calc(${t.spacing(1)} + var(--TreeView-itemChildrenIndentation) * var(--TreeView-itemDepth))`}}]})),Bn=Et(jn,{name:"MuiTreeItem",slot:"GroupTransition",overridesResolver:(t,s)=>s.groupTransition,shouldForwardProp:t=>Xt(t)&&t!=="indentationAtItemLevel"})({margin:0,padding:0,paddingLeft:"var(--TreeView-itemChildrenIndentation)",variants:[{props:{indentationAtItemLevel:!0},style:{paddingLeft:0}}]}),X=a.forwardRef(function(s,r){var We,$e,He,Dt;const{icons:i,runItemPlugins:c,items:{disabledItemsFocusable:u,indentationAtItemLevel:y},selection:{disableSelection:j},expansion:{expansionTrigger:C},treeId:x,instance:b}=os(),p=a.useContext(dn),g=Ln({props:s,name:"MuiTreeItem"}),{children:K,className:z,slots:v,slotProps:w,ContentComponent:V=cs,ContentProps:B,itemId:P,id:q,label:f,onClick:O,onMouseDown:k,onBlur:D,onKeyDown:R}=g,S=Ye(g,_n),{expanded:T,focused:o,selected:m,disabled:h,editing:M,handleExpansion:F,handleCancelItemLabelEditing:H,handleSaveItemLabel:W}=ls(P),{contentRef:E,rootRef:U,propsEnhancers:$}=c(g),ee=a.useRef(null),ce=a.useRef(null),ge=Ft(r,U,ee),ze=Ft(B==null?void 0:B.ref,E,ce),he={expandIcon:(v==null?void 0:v.expandIcon)??i.slots.expandIcon??xn,collapseIcon:(v==null?void 0:v.collapseIcon)??i.slots.collapseIcon??un,endIcon:(v==null?void 0:v.endIcon)??i.slots.endIcon,icon:v==null?void 0:v.icon,groupTransition:v==null?void 0:v.groupTransition},fe=_=>Array.isArray(_)?_.length>0&&_.some(fe):!!_,je=fe(K),de=N({},g,{expanded:T,focused:o,selected:m,disabled:h,indentationAtItemLevel:y}),Y=On(de),be=he.groupTransition??void 0,Xe=it({elementType:be,ownerState:{},externalSlotProps:w==null?void 0:w.groupTransition,additionalProps:N({unmountOnExit:!0,in:T,component:"ul",role:"group"},y?{indentationAtItemLevel:!0}:{}),className:Y.groupTransition}),Ze=_=>{C==="iconContainer"&&F(_)},Ie=T?he.collapseIcon:he.expandIcon,gt=it({elementType:Ie,ownerState:{},externalSlotProps:_=>T?N({},Ee(i.slotProps.collapseIcon,_),Ee(w==null?void 0:w.collapseIcon,_)):N({},Ee(i.slotProps.expandIcon,_),Ee(w==null?void 0:w.expandIcon,_)),additionalProps:{onClick:Ze}}),Be=Ye(gt,An),ht=je&&Ie?e.jsx(Ie,N({},Be)):null,Fe=je?void 0:he.endIcon,ft=it({elementType:Fe,ownerState:{},externalSlotProps:_=>je?{}:N({},Ee(i.slotProps.endIcon,_),Ee(w==null?void 0:w.endIcon,_))}),jt=Ye(ft,Mn),bt=Fe?e.jsx(Fe,N({},jt)):null,Ne=he.icon,yt=it({elementType:Ne,ownerState:{},externalSlotProps:w==null?void 0:w.icon}),n=Ye(yt,Dn),I=Ne?e.jsx(Ne,N({},n)):null;let L;m?L=!0:j||h?L=void 0:L=!1;function Q(_){!o&&(!h||u)&&_.currentTarget===_.target&&b.focusItem(_,P)}function ne(_){var we,Ge,Lt,Ot;D==null||D(_),!(M||_.relatedTarget&&Bt(_.relatedTarget,ee.current)&&(_.target&&((Ge=(we=_.target)==null?void 0:we.dataset)==null?void 0:Ge.element)==="labelInput"&&Bt(_.target,ee.current)||((Ot=(Lt=_.relatedTarget)==null?void 0:Lt.dataset)==null?void 0:Ot.element)==="labelInput"))&&b.removeFocusedItem()}const ae=_=>{var we,Ge;R==null||R(_),((Ge=(we=_.target)==null?void 0:we.dataset)==null?void 0:Ge.element)!=="labelInput"&&b.handleItemKeyDown(_,P)},re=gn({itemId:P,treeId:x,id:q}),ve=b.canItemBeTabbed(P)?0:-1,ye={rootRefObject:ee,contentRefObject:ce,interactions:{handleSaveItemLabel:W,handleCancelItemLabelEditing:H}},et=((We=$.root)==null?void 0:We.call($,N({},ye,{externalEventHandlers:Nt(S)})))??{},tt=(($e=$.content)==null?void 0:$e.call($,N({},ye,{externalEventHandlers:Nt(B)})))??{},Ke=((He=$.dragAndDropOverlay)==null?void 0:He.call($,N({},ye,{externalEventHandlers:{}})))??{},Ve=((Dt=$.labelInput)==null?void 0:Dt.call($,N({},ye,{externalEventHandlers:{}})))??{};return e.jsx(mn,{itemId:P,children:e.jsxs(Rn,N({className:Qt(Y.root,z),role:"treeitem","aria-expanded":je?T:void 0,"aria-selected":L,"aria-disabled":h||void 0,id:re,tabIndex:ve},S,{ownerState:de,onFocus:Q,onBlur:ne,onKeyDown:ae,ref:ge,style:y?N({},S.style,{"--TreeView-itemDepth":typeof p=="function"?p(P):p}):S.style},et,{children:[e.jsx(zn,N({as:V,classes:{root:Y.content,expanded:Y.expanded,selected:Y.selected,focused:Y.focused,disabled:Y.disabled,editable:Y.editable,editing:Y.editing,iconContainer:Y.iconContainer,label:Y.label,labelInput:Y.labelInput,checkbox:Y.checkbox},label:f,itemId:P,onClick:O,onMouseDown:k,icon:I,expansionIcon:ht,displayIcon:bt,ownerState:de},B,tt,Ke.action==null?{}:{dragAndDropOverlayProps:Ke},Ve.value==null?{}:{labelInputProps:Ve},{ref:ze})),K&&e.jsx(Bn,N({as:be},Xe,{children:K}))]}))})}),me=()=>e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"10px",padding:"30px"},children:[e.jsx(zs,{sx:{width:"1em !important",height:"1em !important"}}),e.jsx(Me,{children:"Loading..."})]}),Oe={columns:[],data:[],initialState:{},enableColumnActions:!1,enableColumnFilters:!1,enablePagination:!1,enableSorting:!1,enableBottomToolbar:!1,enableTopToolbar:!1,muiTablePaperProps:{sx:{display:"grid",boxShadow:"none"}},muiTableProps:{sx:{border:"unset","& th, td":{borderTop:"unset",borderRight:"unset",borderLeft:"unset"}}},muiTableHeadCellProps:{sx:{paddingTop:"1rem",paddingRight:"1rem",paddingBottom:"1rem",paddingLeft:"1rem"}},muiTableBodyRowProps:{hover:!0},muiTableBodyCellProps:{sx:{verticalAlign:"top"}}},Re=({msg:t})=>e.jsx(l,{sx:{padding:"1rem 0"},children:e.jsx(Me,{children:t})}),Fn=a.lazy(()=>se(()=>import("./Alert-1.0.43-BeyiDeYu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Nn=({dbs:t,tbl:s,database:r})=>{d.debug(t,s);const i=J(),c=r.columnsLoaded[s]??!1,u=a.useMemo(()=>(r==null?void 0:r.columns[s])??[],[r.columns]),[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{us(t,s,p=>{const g=p==null?void 0:p.data;d.debug("response data",g),i(bs({dbs:t,tbl:s,cls:g}))},p=>{d.error("error",p),j(p??Z.contactSupport)})},x=a.useMemo(()=>[{accessorKey:"ordinal_position",header:"#",size:40},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"column_type",header:"Column type",size:100},{accessorKey:"is_nullable",header:"Nullable?",size:50},{accessorKey:"character_maximum_length",header:"Max length",size:70,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"numeric_precision",header:"Precision",size:60,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"numeric_scale",header:"Scale",size:60,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"extra",header:"Extra",size:100},{accessorKey:"column_default",header:"Default value",size:100}],[]),b=De({...Oe,columns:x,data:u,initialState:{columnOrder:["ordinal_position","column_name","column_type","is_nullable","extra","column_default","character_maximum_length","numeric_precision","numeric_scale"],density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return d.debug(b),y!==""?e.jsx(a.Suspense,{children:e.jsx(Fn,{severity:"error",message:y,close:!1})}):c?c&&u.length===0?e.jsx(Re,{msg:"Table has no columns"}):(d.debug(u),e.jsx(Le,{table:b})):e.jsx(me,{})},Kn=a.lazy(()=>se(()=>import("./Alert-1.0.43-BeyiDeYu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Vn=({dbs:t,tbl:s,database:r})=>{d.debug(t,s);const i=J(),c=r.indexesLoaded[s]??!1,u=a.useMemo(()=>(r==null?void 0:r.indexes[s])??[],[r.indexes]),[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{xs(t,s,p=>{const g=p==null?void 0:p.data;d.debug("response data",g),i(ys({dbs:t,tbl:s,idx:g}))},p=>{d.error("error",p),j(p??Z.contactSupport)})},x=a.useMemo(()=>[{accessorKey:"index_name",header:"Index name",size:100},{accessorKey:"non_unique",header:"Unique",size:80},{accessorKey:"seq_in_name",header:"#",size:40,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"collation",header:"Collation",size:80},{accessorKey:"nullable",header:"Nullable?",size:80},{accessorKey:"index_type",header:"Index type",size:100},{accessorKey:"cardinality",header:"Cardinality",size:80,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}}],[]),b=De({...Oe,columns:x,data:u,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return d.debug(b),y!==""?e.jsx(a.Suspense,{children:e.jsx(Kn,{severity:"error",message:y,close:!1})}):c?c&&u.length===0?e.jsx(Re,{msg:"Table has no indexes"}):e.jsx(Le,{table:b}):e.jsx(me,{})},Wn=a.lazy(()=>se(()=>import("./Alert-1.0.43-BeyiDeYu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),$n=({dbs:t,tbl:s,database:r})=>{d.debug(t,s);const i=J(),c=r.triggersLoaded[s]??!1,u=a.useMemo(()=>(r==null?void 0:r.triggers[s])??[],[r.triggers]),[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{ms(t,s,p=>{const g=p==null?void 0:p.data;d.debug("response data",g),i(Ss({dbs:t,tbl:s,trg:g}))},p=>{d.error("error",p),j(p??Z.contactSupport)})},x=a.useMemo(()=>[{accessorKey:"trigger_name",header:"Trigger name",size:120},{accessorKey:"event_manipulation",header:"Event",size:80},{accessorKey:"action_timing",header:"Timin",size:80},{accessorKey:"action_statement",header:"SQL",size:200,Cell:({cell:p})=>e.jsx("pre",{style:{padding:0,margin:0},children:p.getValue()})}],[]),b=De({...Oe,columns:x,data:u,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return d.debug(b),y!==""?e.jsx(a.Suspense,{children:e.jsx(Wn,{severity:"error",message:y,close:!1})}):c?c&&u.length===0?e.jsx(Re,{msg:"Table has no triggers"}):e.jsx(Le,{table:b}):e.jsx(me,{})},Hn=a.lazy(()=>se(()=>import("./Alert-1.0.43-BeyiDeYu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Gn=({dbs:t,tbl:s,database:r})=>{d.debug(t,s);const i=J(),c=r.foreignKeysLoaded[s]??!1,u=a.useMemo(()=>(r==null?void 0:r.foreignKeys[s])??[],[r.foreignKeys]),[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{gs(t,s,p=>{const g=p==null?void 0:p.data;d.debug("response data",g),i(Cs({dbs:t,tbl:s,frk:g}))},p=>{d.error("error",p),j(p)})},x=a.useMemo(()=>[{accessorKey:"constraint_name",header:"Constraint name",size:100},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"referenced_table_name",header:"Referenced table",size:100},{accessorKey:"referenced_column_name",header:"Referenced column",size:100}],[]),b=De({...Oe,columns:x,data:u,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return d.debug(b),y!==""?e.jsx(a.Suspense,{children:e.jsx(Hn,{severity:"error",message:y,close:!1})}):c?c&&u.length===0?e.jsx(Re,{msg:"Table contains no foreign keys"}):e.jsx(Le,{table:b}):e.jsx(me,{})},ds=a.memo(({dbs:t,tbl:s,typ:r,database:i})=>(d.debug(t,s,r),e.jsxs(e.Fragment,{children:[e.jsx(X,{itemId:t+"-"+s+"-columns",label:e.jsxs(l,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Vs,{}),e.jsx("span",{children:"Columns"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Nn,{dbs:t,tbl:s,database:i})}),r===xe.TABLE&&e.jsxs(e.Fragment,{children:[e.jsx(X,{itemId:t+"-"+s+"-indexes",label:e.jsxs(l,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Ws,{}),e.jsx("span",{children:"Indexes"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Vn,{dbs:t,tbl:s,database:i})}),e.jsx(X,{itemId:t+"-"+s+"-foreignkeys",label:e.jsxs(l,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(rn,{}),e.jsx("span",{children:"Foreign Keys"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Gn,{dbs:t,tbl:s,database:i})}),e.jsx(X,{itemId:t+"-"+s+"-triggers",label:e.jsxs(l,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Zt,{}),e.jsx("span",{children:"Triggers"})]}),sx:{padding:0,minWidth:0},children:e.jsx($n,{dbs:t,tbl:s,database:i})})]})]}))),ps=a.memo(({dbs:t,tbl:s,typ:r,tableContext:i,database:c})=>{var b,p;d.debug(t,s,r);const u=J(),y=c.tablesSelected,j=c.viewsSelected,C=bn("(max-width:900px)"),x=a.useMemo(()=>(i==null?void 0:i.wp_tables)!==void 0&&i.wp_tables.filter(g=>g===s).length>0?" (WordPress Table)":(i==null?void 0:i.wpda_tables)!==void 0&&i.wpda_tables.filter(g=>g===s).length>0?" (Plugin Table)":"",[]);return e.jsxs(l,{color:"primary",sx:{display:"grid",gridTemplateColumns:"calc(100% - 110px) auto",justifyContent:"space-between",alignItems:"center",gridGap:"20px",marginLeft:"-10px","&:hover":{".pp-row-actions":{visibility:C?"hidden":"visible"}}},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gridGap:"0",overflow:"hidden"},children:[e.jsx(l,{sx:{display:"grid",alignItems:"center"},children:e.jsx(pe,{size:"small",checked:j.includes(s)||y.includes(s),onClick:g=>{r===xe.VIEW?u(Ts({dbs:t,vws:s,isSelected:!j.includes(s)})):u(Is({dbs:t,tbl:s,isSelected:!y.includes(s)})),g.stopPropagation()}})}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"stretch"},children:[e.jsxs(l,{sx:{textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[s," ",x]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto auto auto",gridGap:"10px",marginLeft:"10px",alignItems:"center",visibility:"hidden"},className:"pp-row-actions",children:[e.jsx(l,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(Ue,{title:"Manage table `"+s+"`",placement:"bottom",children:e.jsx(ke,{underline:"none",onClick:g=>{u(st({dbs:t,tbl:s,typ:r,explorerAction:ot.MANAGE})),g.preventDefault(),g.stopPropagation()},children:"Manage"})}),e.jsx(l,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(Ue,{title:"Explore table `"+s+"`",placement:"bottom",children:e.jsx(ke,{underline:"none",onClick:g=>{u(st({dbs:t,tbl:s,typ:r,explorerAction:ot.EXPLORE})),g.preventDefault(),g.stopPropagation()},children:"Explore"})})]})]})]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-evenly",alignItems:"center"},children:[e.jsx(Ue,{title:"Manage table `"+s+"`",placement:"bottom",children:e.jsx(le,{sx:{color:(b=Ce)==null?void 0:b.palette.primary.main},onClick:g=>{u(st({dbs:t,tbl:s,typ:r,explorerAction:ot.MANAGE})),g.preventDefault(),g.stopPropagation()},children:e.jsx($s,{})})}),e.jsx(Ue,{title:"Explore table `"+s+"`",placement:"bottom",children:e.jsx(le,{sx:{color:(p=Ce)==null?void 0:p.palette.primary.main},onClick:g=>{u(st({dbs:t,tbl:s,typ:r,explorerAction:ot.EXPLORE})),g.preventDefault(),g.stopPropagation()},children:e.jsx(Hs,{})})})]})]})}),qn=a.lazy(()=>se(()=>import("./Alert-1.0.43-BeyiDeYu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Yn=a.memo(({dbs:t,search:s,database:r})=>{const i=J();d.debug(t,s);const c=r.tablesLoaded,u=r.tables,y=r.tablesContext,[j,C]=a.useState("");return a.useEffect(()=>{c||Ht(t,function(x){const b=x==null?void 0:x.data;d.debug("response data",b),i(vs({dbs:t,tbl:b,context:x.context??void 0}))},x=>{d.error("error",x),C(x??Z.contactSupport)})},[c]),j!==""?e.jsx(a.Suspense,{children:e.jsx(qn,{severity:"error",message:j,close:!1})}):c?c&&u.length===0?e.jsx(l,{sx:{padding:"1rem"},children:e.jsx(Me,{children:"Database contains no tables"})}):e.jsxs(e.Fragment,{children:[...u.map(x=>{const b=!Te(x,s);return e.jsx(X,{itemId:t+"-"+x,label:e.jsx(ps,{dbs:t,tbl:x,typ:xe.TABLE,tableContext:y,database:r}),sx:{visibility:b?"hidden":"inherit",position:b?"fixed !important":"inherit"},children:e.jsx(ds,{dbs:t,tbl:x,typ:xe.TABLE,database:r})})})]}):e.jsx(me,{})}),Un=a.lazy(()=>se(()=>import("./Alert-1.0.43-BeyiDeYu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Jn=({dbs:t,search:s,database:r})=>{const i=J();d.debug(t,s);const c=r.viewsLoaded,u=r.views,[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{hs(t,x=>{const b=x==null?void 0:x.data;d.debug("response data",b),i(ws({dbs:t,vws:b}))},x=>{d.error("error",x),j(x??Z.contactSupport)})};return y!==""?e.jsx(a.Suspense,{children:e.jsx(Un,{severity:"error",message:y,close:!1})}):c?c&&u.length===0?e.jsx(l,{sx:{padding:"1rem"},children:e.jsx(Me,{children:"Database contains no views"})}):e.jsxs(e.Fragment,{children:[...u.map(x=>{const b=!Te(x,s);return e.jsx(X,{itemId:t+"-"+x,label:e.jsx(ps,{dbs:t,tbl:x,typ:xe.VIEW,database:r}),sx:{visibility:b?"hidden":"unset",position:b?"fixed !important":"inherit"},children:e.jsx(ds,{dbs:t,tbl:x,typ:xe.VIEW,database:r})})})]}):e.jsx(me,{})},Qn=a.lazy(()=>se(()=>import("./Alert-1.0.43-BeyiDeYu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Xn=({dbs:t,search:s,database:r})=>{d.debug(t,s);const i=J(),c=r.proceduresLoaded,u=r.procedures,[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{fs(t,p=>{const g=p==null?void 0:p.data;d.debug("response data",g),i(Es({dbs:t,prc:g}))},p=>{d.error("error",p),j(p??Z.contactSupport)})},x=a.useMemo(()=>[{accessorKey:"routine_name",header:"Name",size:100},{accessorKey:"routine_definition",header:"Body",size:300,Cell:({cell:p})=>e.jsx("pre",{style:{padding:0,margin:0},children:p.getValue()})}],[]),b=De({...Oe,columns:x,data:u.filter(p=>Te(p.routine_name,s)),initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return d.debug(b),y!==""?e.jsx(a.Suspense,{children:e.jsx(Qn,{severity:"error",message:y,close:!1})}):c?c&&u.length===0?e.jsx(Re,{msg:"Database contains no stored procedures"}):e.jsx(Le,{table:b}):e.jsx(me,{})},Zn=a.lazy(()=>se(()=>import("./Alert-1.0.43-BeyiDeYu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),ea=({dbs:t,search:s,database:r})=>{d.debug(t,s);const i=J(),c=r.functionsLoaded,u=r.functions,[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{js(t,p=>{const g=p==null?void 0:p.data;d.debug("response data",g),i(ks({dbs:t,fnc:g}))},p=>{d.error("error",p),j(p??Z.contactSupport)})},x=a.useMemo(()=>[{accessorKey:"routine_name",header:"Name",size:100},{accessorKey:"routine_definition",header:"Body",size:300,Cell:({cell:p})=>e.jsx("pre",{style:{padding:0,margin:0},children:p.getValue()})}],[]),b=De({...Oe,columns:x,data:u.filter(p=>Te(p.routine_name,s)),initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return d.debug(b),y!==""?e.jsx(a.Suspense,{children:e.jsx(Zn,{severity:"error",message:y,close:!1})}):c?c&&u.length===0?e.jsx(Re,{msg:"Database contains no functions"}):e.jsx(Le,{table:b}):e.jsx(me,{})},ta=({setShowFilter:t})=>{const s=J(),i=mt().dbsTypes;return a.useEffect(()=>{try{localStorage.setItem("ppExplorerSearchDbsTypes",JSON.stringify(i))}catch(c){d.debug(c)}},[i]),e.jsxs(yn,{sx:{position:"absolute",top:"3em",right:"0",minWidth:"-webkit-fill-available",zIndex:9999999},children:[e.jsx(Cn,{title:"Database filter",sx:{textAlign:"center"}}),e.jsx(Sn,{sx:{textAlign:"center",padding:0,borderTop:"1px solid #eee",borderBottom:"1px solid #eee"},children:e.jsxs(l,{sx:{display:"inline-grid",textAlign:"left",padding:"2em","& label":{display:"flex",alignItems:"center"}},children:[e.jsx(te,{children:e.jsxs(ct,{children:[e.jsx(pe,{size:"small",checked:i.includes(G.WP),onChange:(c,u)=>{s(u?nt({dbsType:G.WP}):at({dbsType:G.WP}))}}),"WordPress database"]})}),e.jsx(te,{children:e.jsxs(ct,{children:[e.jsx(pe,{size:"small",checked:i.includes(G.LOCAL),onChange:(c,u)=>{s(u?nt({dbsType:G.LOCAL}):at({dbsType:G.LOCAL}))}}),"Local databases"]})}),e.jsx(te,{children:e.jsxs(ct,{children:[e.jsx(pe,{size:"small",checked:i.includes(G.REMOTE),onChange:(c,u)=>{s(u?nt({dbsType:G.REMOTE}):at({dbsType:G.REMOTE}))}}),"Remote databases"]})}),e.jsx(te,{children:e.jsxs(ct,{children:[e.jsx(pe,{size:"small",checked:i.includes(G.SYSTEM),onChange:(c,u)=>{s(u?nt({dbsType:G.SYSTEM}):at({dbsType:G.SYSTEM}))}}),"System databases"]})})]})}),e.jsxs(Tn,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr"},children:[e.jsx(l,{}),e.jsx(_e,{variant:"contained",onClick:()=>t(!1),children:"OK"})]})]})},Pe=({search:t,setSearch:s,addFilter:r})=>{d.debug(t,r);const[i,c]=a.useState(!1);return e.jsxs(l,{sx:{position:"relative"},children:[e.jsx(Se,{className:"pp-explorer-search-field",value:t,type:"search",onChange:u=>{s(u.target.value)},onClick:u=>{u.stopPropagation()},onKeyDown:u=>{u.stopPropagation()},sx:{backgroundColor:"#fff",fontSize:"1em",margin:0,padding:0,borderRadius:"4px","&.MuiFormControl-root.MuiTextField-root .MuiInputBase-root":{paddingRight:0},"&.MuiFormControl-root.MuiTextField-root input":{padding:"8px"}},slotProps:{input:{startAdornment:e.jsx(Kt,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(qs,{})}),endAdornment:e.jsx(e.Fragment,{children:r&&e.jsx(Kt,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(le,{onClick:()=>{c(!i)},children:e.jsx(Gs,{})})})})}}}),i&&e.jsx(ta,{setShowFilter:c})]})},sa=(t,s)=>{const r=Qe(i=>i.explorer.database===void 0||i.explorer.database===null||i.explorer.database[t].tables.length===0?!1:i.explorer.database[t].tables.filter(u=>Te(u,s)).length===i.explorer.database[t].tablesSelected.length);return d.debug("allTablesSelected",r),r},na=(t,s)=>{const r=Qe(i=>i.explorer.database===void 0||i.explorer.database===null||i.explorer.database[t].views.length===0?!1:i.explorer.database[t].views.filter(u=>Te(u,s)).length===i.explorer.database[t].viewsSelected.length);return d.debug("allViewsSelected",r),r},Je=t=>{let s="";try{s=localStorage.getItem(t)??""}catch(u){d.debug(u)}const[r,i]=a.useState(s),c=u=>{i(u);try{localStorage.setItem(t,u)}catch(y){d.debug(y)}};return d.debug(r),{search:r,setSearch:c}},aa=a.memo(({dbs:t,density:s})=>{d.debug(t);const r=J(),[i,c]=a.useState(!1),{search:u,setSearch:y}=Je(`ppExplorerSearchTables-${t}`);d.debug(i,u);const[j,C]=a.useState(!1),{search:x,setSearch:b}=Je(`ppExplorerSearchViews-${t}`);d.debug(j,x);const[p,g]=a.useState(!1),{search:K,setSearch:z}=Je(`ppExplorerSearchProcedures-${t}`);d.debug(p,K);const[v,w]=a.useState(!1),{search:V,setSearch:B}=Je(`ppExplorerSearchFunctions-${t}`);d.debug(v,V);const P=sa(t,u),q=na(t,x),[f,O]=a.useState("");d.debug(f);const k=kt(),D=k[t],R=()=>s==="small"?0:s==="medium"?"6px":"12px";return e.jsxs(e.Fragment,{children:[e.jsx(X,{itemId:t+"-tables",className:"pp-data-exporer-table-tree-item "+f,onClickCapture:S=>{var T,o;!(S.target instanceof HTMLInputElement)&&!(S.target instanceof HTMLAnchorElement)&&!((T=S.target.closest("span"))!=null&&T.classList.contains("pp-select-all-tables"))&&((o=S.target.closest("li"))!=null&&o.classList.contains("pp-data-exporer-table-tree-item"))&&(O(f===""?"hide-details":""),i?S.stopPropagation():(c(!0),O("")))},sx:{padding:0,minWidth:0,"&.hide-details > ul":{visibility:"hidden",position:"fixed"}},label:e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:i&&f===""?0:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[i&&f===""?e.jsx(pe,{size:"small",className:"pp-select-all-tables",checked:P,onClick:S=>{r(qt({dbs:t,isSelected:!P,search:u})),S.stopPropagation()},sx:{marginLeft:"-12px"}}):e.jsx(es,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Tables"}),e.jsx("span",{style:{fontSize:"90%"},children:k[t].tablesLoaded===!0?"("+k[t].tables.length+"/"+k[t].tablesSelected.length+")":""})]})]}),e.jsxs(l,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(l,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(ke,{underline:"none",onClick:S=>{r(Yt({dbs:t})),S.preventDefault(),S.stopPropagation()},children:"Refresh"})]})]}),e.jsx(l,{sx:{marginRight:R()},children:i&&f===""&&e.jsx(Pe,{search:u,setSearch:y})})]}),children:e.jsx(Yn,{dbs:t,search:u,database:D})}),e.jsx(X,{itemId:t+"-views",onClick:()=>{C(!j)},label:e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:j?0:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[j?e.jsx(pe,{size:"small",checked:q,onClick:S=>{r(Ut({dbs:t,isSelected:!q,search:x})),S.stopPropagation()},sx:{marginLeft:"-12px"}}):e.jsx(ts,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Views"}),e.jsx("span",{style:{fontSize:"90%"},children:k[t].viewsLoaded===!0?"("+k[t].views.length+"/"+k[t].viewsSelected.length+")":""})]})]}),e.jsxs(l,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(l,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(ke,{underline:"none",onClick:S=>{r(Jt({dbs:t})),S.preventDefault(),S.stopPropagation()},children:"Refresh"})]})]}),e.jsx(l,{sx:{marginRight:R()},children:j&&e.jsx(Pe,{search:x,setSearch:b})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Jn,{dbs:t,search:x,database:D})}),e.jsx(X,{itemId:t+"-procedures",onClick:()=>{g(!p)},label:e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[e.jsx(Zt,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Stored Procedures"}),e.jsx("span",{style:{fontSize:"90%"},children:k[t].proceduresLoaded===!0?"("+k[t].procedures.length+")":""})]})]}),e.jsxs(l,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(l,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(ke,{underline:"none",onClick:S=>{r(Ps({dbs:t})),S.preventDefault(),S.stopPropagation()},children:"Refresh"})]})]}),e.jsx(l,{sx:{marginRight:R()},children:p&&e.jsx(Pe,{search:K,setSearch:z})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Xn,{dbs:t,search:K,database:D})}),e.jsx(X,{itemId:t+"-functions",onClick:()=>{w(!v)},label:e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[e.jsx(on,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Functions"}),e.jsx("span",{style:{fontSize:"90%"},children:k[t].functionsLoaded===!0?"("+k[t].functions.length+")":""})]})]}),e.jsxs(l,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(l,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(ke,{underline:"none",onClick:S=>{r(_s({dbs:t})),S.preventDefault(),S.stopPropagation()},children:"Refresh"})]})]}),e.jsx(l,{sx:{marginRight:R()},children:v&&e.jsx(Pe,{search:V,setSearch:B})})]}),sx:{padding:0,minWidth:0},children:e.jsx(ea,{dbs:t,search:V,database:D})})]})}),ra=()=>{const t=Qe(s=>s.explorer.database===void 0||s.explorer.database===null?0:Object.keys(s.explorer.database).map(r=>s.explorer.database[r].tablesSelected).flat().length);return d.debug("countSelectedTables",t),t},ia=()=>{const t=Qe(s=>s.explorer.database===void 0||s.explorer.database===null?!1:Object.keys(s.explorer.database).filter(r=>s.explorer.database[r].tablesSelected.length>0||s.explorer.database[r].viewsSelected.length>0).length>0);return d.debug("hasBulkActions",t),t},oa=()=>{const t=Qe(s=>s.explorer.database===void 0||s.explorer.database===null?0:Object.keys(s.explorer.database).map(r=>s.explorer.database[r].viewsSelected).flat().length);return d.debug("countSelectedViews",t),t},qe={export:"Export table(s)",truncate:"Truncate table(s)",drop:"Drop table(s)/view(s)"},la=()=>{const t=J(),s=ia(),r=mt(),i=kt(),c=ra(),u=oa(),y=r.context,[j,C]=a.useState({}),[x,b]=a.useState("*"),[p,g]=a.useState(null),[K,z]=a.useState(!1),[v,w]=a.useState(!1),[V,B]=a.useState(!1);a.useEffect(()=>{c===0&&(x==="export"||x==="truncate")&&b("*")},[c]);const P={vertical:"top",horizontal:"right"},q=()=>{const o={};return i==null?{}:(Object.keys(i).map(m=>{i[m].tablesSelected.map(h=>{o[m]===void 0&&(o[m]={}),o[m][h]={status:null,typ:xe.TABLE}}),x==="drop"&&i[m].viewsSelected.map(h=>{o[m]===void 0&&(o[m]={}),o[m][h]={status:null,typ:xe.VIEW}})}),o)},f=(o,m,h)=>{const M={...j};m==="*"?Object.keys(M[o]).map(F=>M[o][F].status=h):M[o][m].status=h,C(M)},O=()=>{Object.keys(j).length>0&&Object.keys(j).map(o=>{window.document.getElementById(`pp-export-tables-${o}`).submit(),f(o,"*",!0)})},k=()=>{Object.keys(j).length>0&&Object.keys(j).map(o=>{Object.keys(j[o]).map(m=>{Fs(o,m,h=>{d.debug(h),(h==null?void 0:h.code)==="ok"&&(h==null?void 0:h.message)!==void 0?f(o,m,!0):f(o,m,!1)},h=>{d.error("error",o,m,h),f(o,m,!1)})})})},D=()=>{Object.keys(j).length>0&&Object.keys(j).map(o=>{Object.keys(j[o]).map(m=>{Bs(o,m,j[o][m].typ,h=>{d.debug(h),(h==null?void 0:h.code)==="ok"&&(h==null?void 0:h.message)!==void 0?f(o,m,!0):f(o,m,!1)},h=>{d.error("error",h),f(o,m,!1)})})})},R=o=>e.jsxs(_t,{sx:{"& th":{fontWeight:"bold",padding:"4px 6px"},"& td":{padding:"4px 6px",border:"none"}},children:[e.jsx(Mt,{children:e.jsxs(Ae,{children:[e.jsx(A,{children:"Database"}),e.jsx(A,{children:"Table | View"}),e.jsx(A,{children:"Status"})]})}),e.jsx(At,{children:Object.keys(o).map(m=>Object.keys(o[m]).map((h,M)=>{var F,H;return e.jsxs(Ae,{children:[e.jsx(A,{children:M===0?m:null}),e.jsx(A,{children:h}),e.jsxs(A,{children:[o[m][h]===null&&e.jsx(Us,{style:{display:"block",margin:"0 auto"}}),o[m][h].status===!0&&e.jsx(as,{color:(F=Ce)==null?void 0:F.palette.success.main,style:{display:"block",margin:"0 auto"}}),o[m][h].status===!1&&e.jsx(rs,{color:(H=Ce)==null?void 0:H.palette.error.main,style:{display:"block",margin:"0 auto"}})]})]},M)}))})]}),S=()=>e.jsx(l,{children:R(j)}),T=()=>{const o=q();return C(o),e.jsxs(l,{children:[R(o),(x==="truncate"||x==="drop")&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{marginTop:"20px"}}),e.jsx(l,{sx:{marginTop:"20px",marginBottom:"20px"},children:x==="drop"?e.jsx("span",{children:"Deletes views and tables with all data permanently."}):e.jsx("span",{children:"Deletes all data permanently."})}),e.jsx(l,{children:e.jsx("strong",{children:"This actions cannot be undone!"})}),e.jsxs(l,{children:["'",e.jsx("strong",{children:"NO"}),"' to stop, '",e.jsx("strong",{children:"YES"}),"' to continue."]}),e.jsxs(l,{sx:{marginTop:"20px",fontSize:"80%",display:"inline-grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",gap:"5px"},children:[e.jsx(Ys,{}),e.jsxs("span",{children:["Does not ",x," WordPress tables"]})]})]})]})};return s?e.jsxs(e.Fragment,{children:[e.jsx(ss,{className:"pp-bulk-actions-container",color:"inherit",position:"relative",elevation:4,sx:{margin:"0 0 5px 0"},children:e.jsxs(ns,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between"},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(te,{variant:"standard",sx:{minWidth:200},children:e.jsxs(xt,{MenuProps:{id:"pp-select-menu"},value:x,onChange:o=>{b(o.target.value)},children:[e.jsx(ue,{value:"*",children:"Bulk actions"}),e.jsx(ue,{value:"export",disabled:c===0,children:qe.export}),e.jsx(ue,{value:"truncate",disabled:c===0,children:qe.truncate}),e.jsx(ue,{value:"drop",children:qe.drop})]})}),e.jsx(_e,{variant:"contained",onClick:()=>{x!=="*"?(g(T()),z(!0)):w(!0)},children:"Apply"})]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between"},children:[e.jsx(Rt,{badgeContent:c,color:"info",anchorOrigin:P,children:e.jsx(es,{color:"action",size:20})}),e.jsx(Rt,{badgeContent:u,color:"info",anchorOrigin:P,children:e.jsx(ts,{color:"action",size:20})})]})]})}),x==="export"&&Object.keys(j).map(o=>e.jsxs("form",{id:"pp-export-tables-"+o,action:y.wp.home+"?action=wpda_export",method:"post",target:"_blank",children:[e.jsx("input",{type:"hidden",name:"type",value:"table"}),e.jsx("input",{type:"hidden",name:"wpdaschema_name",value:o}),Object.keys(j[o]).map(m=>e.jsx("input",{type:"hidden",name:"table_names[]",value:m},m)),e.jsx("input",{type:"hidden",name:"_wpnonce",value:y.wp.nonce.split("-")[0]})]},"pp-export-tables-"+o)),e.jsx(wt,{title:"Apply bulk action",message:"No bulk action selected",open:v,setOpen:w}),e.jsx(Pt,{title:qe[x],message:p,open:K,setOpen:z,onConfirm:()=>{switch(B(!0),x){case"export":O();break;case"truncate":k();break;case"drop":D()}}}),e.jsx(wt,{title:qe[x],message:S(),open:V,setOpen:B,onConfirm:()=>{Object.keys(j).map(o=>{t(Yt({dbs:o})),t(qt({dbs:o,isSelected:!1,search:""})),t(Jt({dbs:o})),t(Ut({dbs:o,isSelected:!1,search:""}))})}})]}):null},ca=({setDoImport:t})=>{var R,S,T;const s=mt(),r=kt(),i=s.context,[c,u]=a.useState(""),[y,j]=a.useState("");a.useEffect(()=>{if(r!=null&&Object.keys(r).length>0){const o=Object.keys(r).filter(m=>r[m].dbsType===G.WP);(o==null?void 0:o.length)>0&&u(o[0])}},[r]);const C=a.useRef(null),[x,b]=a.useState(null),p=(R=i==null?void 0:i.wp)!=null&&R.zip?".sql,.zip":".sql",g=(S=i==null?void 0:i.wp)!=null&&S.zip?"SQL and ZIP":"SQL",K=(T=i==null?void 0:i.wp)==null?void 0:T.upload,[z,v]=a.useState(!1),[w,V]=a.useState(null),[B,P]=a.useState(!1),[q,f]=a.useState(""),[O,k]=a.useState(null),D=o=>e.jsx(e.Fragment,{children:e.jsxs(_t,{sx:{"& th":{fontWeight:"bold",padding:"4px 6px"},"& td":{padding:"4px 6px",border:"none"}},children:[e.jsx(Mt,{children:e.jsxs(Ae,{children:[e.jsx(A,{children:"Import file"}),e.jsx(A,{children:"Message"}),e.jsx(A,{children:"Status"})]})}),e.jsx(At,{children:o.map(m=>Object.keys(m).map(h=>{var M,F;return e.jsxs(Ae,{children:[e.jsx(A,{sx:{verticalAlign:"text-top"},children:h}),e.jsxs(A,{sx:{verticalAlign:"text-top"},children:[m[h].msg,m[h].errors.map(H=>{var W;return e.jsx("ul",{style:{listStyle:"disc",padding:"0 40px"},children:e.jsx("li",{style:{color:(W=Ce)==null?void 0:W.palette.error.main},children:H})})})]}),e.jsx(A,{sx:{verticalAlign:"text-top"},children:m[h].status==="error"?e.jsx(rs,{color:(M=Ce)==null?void 0:M.palette.error.main,style:{display:"block",margin:"0 auto"}}):e.jsx(as,{color:(F=Ce)==null?void 0:F.palette.success.main,style:{display:"block",margin:"0 auto"}})})]},h)}))})]})});return e.jsxs(e.Fragment,{children:[e.jsxs(ut,{sx:{marginTop:0,marginBottom:"5px",padding:"20px 10px 20px 24px"},elevation:4,className:"pp-import-container",children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingRight:"8px !important",marginBottom:"20px"},children:[e.jsx(Me,{variant:"button",sx:{fontWeight:"bold"},children:"Import data and execute scripts"}),e.jsx(pt,{title:"Close",position:"bottom",children:e.jsx(le,{onClick:()=>{C.current&&(C.current.value=""),j(""),t(!1)},size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(is,{})})})]}),e.jsxs(l,{sx:{display:"grid",gap:"10px",marginRight:"14px",marginBottom:"10px"},children:[e.jsxs(l,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"start",alignItems:"center",gap:"10px"},children:[e.jsx(l,{children:e.jsxs(te,{sx:{minWidth:"300px"},children:[e.jsx(vt,{variant:"outlined",children:"Select destination database"}),e.jsx(xt,{MenuProps:{id:"pp-select-menu"},label:"Select destination database",value:c,onChange:o=>{u(o.target.value)},sx:{"& div.MuiSelect-select":{padding:"12px 14px"}},children:r!=null&&Object.keys(r).map(o=>{const m=r[o].dbsType===G.WP?o+" (WordPress database)":o;return e.jsx(ue,{value:o,children:m},o)})})]})}),e.jsx(l,{children:e.jsx("form",{children:e.jsxs(_e,{component:"label",variant:"outlined",startIcon:e.jsx(Js,{}),sx:{padding:"10px 14px"},children:["Select file(s)",e.jsx(Se,{type:"file",slotProps:{input:{inputRef:C},htmlInput:{accept:p,multiple:!0}},onChange:o=>{const m=o.target.files;b(m);const h=Object.keys(m).map(M=>m[M].name).toString();j(h)},sx:{display:"none"}})]})})}),y!==""&&e.jsx(e.Fragment,{children:e.jsx(l,{children:e.jsx(_e,{component:"label",variant:"contained",startIcon:e.jsx(Qs,{}),sx:{padding:"10px 14px"},onClick:()=>{V(e.jsxs(l,{children:[e.jsxs(l,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["Selected file(s): ",e.jsx("strong",{children:y})]}),e.jsxs(l,{children:["Selected database: ",e.jsx("strong",{children:c})]}),e.jsxs(l,{sx:{marginTop:"20px",fontSize:"80%"},children:[e.jsx("strong",{children:"NOTE"}),"  You can work on other tasks while your import is performed in the background."]})]})),v(!0)},children:"Import file(s)"})})})]}),y!==""&&e.jsxs(l,{sx:{marginTop:"20px",marginBottom:"10px",minWidth:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left",fontWeight:"bold"},children:["Selected file(s): ",y]}),e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"5px",minWidth:0},children:[e.jsx("legend",{children:"IMPORTANT"}),e.jsxs("ul",{style:{paddingLeft:"15px",listStyle:"disc",padding:"0 30px"},children:[e.jsx("li",{children:"Supports multiple file uploads simultaneously."}),e.jsxs("li",{children:["Server supports ",g," file types."]}),e.jsxs("li",{children:["Maximum supported file size on this server is ",K,"."]}),e.jsx("li",{children:"Add a ; and a new line character at the end of every SQL statement."})]})]})]})]}),e.jsx(Pt,{title:"Import selected file(s)?",message:w,open:z,setOpen:v,onConfirm:()=>{Ns(c,x,o=>{var m;if(o!=null&&o.message&&((m=o==null?void 0:o.context)!=null&&m.imported)&&Array.isArray(o.context.imported)){const h=o.context.imported;P(!0),f(o.message),k(D(h))}else oe(Z.contactSupport,{variant:"error"})},o=>{d.error("error",o),oe(Z.contactSupport,{variant:"error"})})}}),e.jsx(wt,{title:q,message:O,open:B,setOpen:P,onConfirm:()=>{j(""),t(!1)}})]})},Wt=a.lazy(()=>se(()=>import("./Alert-1.0.43-BeyiDeYu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),da=({setDoBackup:t})=>{const s=In(),[r,i]=a.useState([]),[c,u]=a.useState("");d.debug("dbs",r);const[y,j]=a.useState([]);d.debug("tables",y);const[C,x]=a.useState({}),[b,p]=a.useState([]),[g,K]=a.useState({}),[z,v]=a.useState([]),[w,V]=a.useState(!1);d.debug("cron",C,g,z,w);const[B,P]=a.useState(!1),[q,f]=a.useState(!1),[O,k]=a.useState(""),[D,R]=a.useState(!1),[S,T]=a.useState({}),[o,m]=a.useState([]),[h,M]=a.useState(""),[F,H]=a.useState(""),[W,E]=a.useState(Tt()),[U,$]=a.useState("nonrepeating"),[ee,ce]=a.useState(""),[ge,ze]=a.useState(0),[he,fe]=a.useState(!1),[je,de]=a.useState(!1),[Y,be]=a.useState(!1),[Xe,Ze]=a.useState(!1),[Ie,gt]=a.useState("");a.useEffect(()=>{Be(),Fe()},[]),a.useEffect(()=>{S!=null&&S.dbs&&(S==null?void 0:S.dbs)!==""&&ft()},[S]),a.useEffect(()=>{const n=[];for(let I in C)if(C[I].wpda_run_scheduled_export){const L=C[I].wpda_run_scheduled_export;Object.keys(L).map(Q=>{var ye,et,tt,Ke,Ve,We,$e,He;const ne=(tt=(et=(ye=L[Q])==null?void 0:ye.args)==null?void 0:et.args)==null?void 0:tt.name,ae=(We=(Ve=(Ke=L[Q])==null?void 0:Ke.args)==null?void 0:Ve.args)==null?void 0:We.params,re=($e=L[Q])==null?void 0:$e.interval,ve=(He=L[Q])==null?void 0:He.schedule;n.push({dt:Tt.unix(Number(I)).format("YYYY-MM-DD HH:mm:ss"),name:ne,params:ae,interval:re,schedule:ve})})}p(n)},[C]),a.useEffect(()=>{D&&(m([]),de(!1),M(""),fe(!1),H(""),be(!1),E(Tt()),$("nonrepeating"),ce(""),ze(0))},[D]);const Be=async()=>{try{await It(dt.appUrlExportSchedules,{}).then(n=>{var I,L,Q,ne,ae,re,ve;d.debug("response",n),((I=n==null?void 0:n.data)==null?void 0:I.code)==="ok"&&((Q=(L=n==null?void 0:n.data)==null?void 0:L.message)!=null&&Q.cron)&&((ae=(ne=n==null?void 0:n.data)==null?void 0:ne.message)==null?void 0:ae.mail)!==void 0&&((ve=(re=n==null?void 0:n.data)==null?void 0:re.message)!=null&&ve.schedules)?(x(n.data.message.cron),K(n.data.message.schedules),v(n.data.message.drives),V(n.data.message.mail),f(!1)):(d.error("Invalid response",n),k("Invalid response"),f(!0))}).catch(n=>{d.error(n),k(n.message),f(!0)})}catch(n){d.error(n),k("Error loading schedules"),f(!0)}},ht=async()=>{try{await It(dt.appUrlExportAdd,{name:h,params:{dbs:S.dbs,tbl:o.join(","),drv:F,eml:ee,fkp:ge},start:(W==null?void 0:W.unix())||0,interval:U}).then(n=>{var I,L;d.debug("response",n),((I=n==null?void 0:n.data)==null?void 0:I.code)==="ok"?(oe("Export successfully scheduled.",{variant:"success"}),Be(),R(!1)):(d.error(n),oe(((L=n==null?void 0:n.data)==null?void 0:L.message)??"Invalid response",{variant:"error"}))}).catch(n=>{var I,L;d.error(n),oe(((L=(I=n==null?void 0:n.response)==null?void 0:I.data)==null?void 0:L.message)??n.message,{variant:"error"})})}catch(n){d.error(n),oe("Invalid response",{variant:"error"})}},Fe=()=>{Gt(n=>{d.debug("response",n),(n==null?void 0:n.code)==="ok"&&(n!=null&&n.data)&&Array.isArray(n.data)?(i(n.data),n.data.map(I=>{I.dbs_type==="wp"&&(u(I.dbs),T(I))}),P(!1)):(d.error("Invalid response",n),k("Invalid response"),P(!0))},n=>{d.error("error",n),k("Error loading databases"),P(!0)})},ft=()=>{Ht(S.dbs,function(n){d.debug("response",n),(n==null?void 0:n.code)==="ok"&&(n!=null&&n.data)&&Array.isArray(n.data)?(j(n.data),P(!1)):(k("Invalid response"),P(!0))},n=>{d.error("error",n),k("Error loading tables"),P(!0)})},jt=()=>e.jsxs("fieldset",{className:"pp-fieldset",children:[e.jsx("legend",{children:"Create new export"}),e.jsxs(l,{sx:{display:"grid",gap:"20px"},children:[e.jsxs(te,{fullWidth:!0,sx:{marginTop:"8px"},children:[e.jsx(Vt,{options:r,value:S,onChange:(n,I)=>{T(I??"")},getOptionLabel:n=>c===n.dbs?n.dbs+" (WordPress database)":(n==null?void 0:n.dbs)??"",renderInput:n=>e.jsx(Se,{...n,label:"Select database *",variant:"outlined"}),sx:{width:"100%"}}),e.jsx(lt,{children:"Each database export requires a separate schedule."})]}),e.jsxs(te,{fullWidth:!0,error:je,children:[e.jsx(Vt,{multiple:!0,options:y,value:o,disableCloseOnSelect:!0,onChange:(n,I)=>{m(I),de(!1),n.stopPropagation()},renderInput:n=>e.jsx(Se,{...n,label:"Select table(s) *",variant:"outlined",error:je}),sx:{width:"100%"}}),e.jsx(lt,{children:"Supports selecting multiple tables."})]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:s.width<600?"1fr":"1fr 1fr",alignItems:"center",gap:"20px"},children:[e.jsx(Se,{type:"text",label:"Schedule Name",fullWidth:!0,required:!0,helperText:"Schedule name must be unique.",value:h,autoComplete:"off",error:he,onChange:n=>{M(n.target.value),fe(!1)}}),e.jsxs(te,{fullWidth:!0,error:Y,children:[e.jsx(vt,{variant:"outlined",children:"Drive *"}),e.jsxs(xt,{MenuProps:{id:"pp-select-menu"},label:"Drive *",value:F,error:Y,onChange:n=>{H(n.target.value),be(!1)},children:[...Object.keys(z).map(n=>e.jsx(ue,{value:z[n],children:z[n]},z[n]))]}),e.jsx(lt,{children:"Target location for saving export files."})]})]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:s.width<600?"1fr":"1fr 1fr",alignItems:"center",gap:"20px"},children:[e.jsx(wn,{dateAdapter:En,children:e.jsx(kn,{label:"Start date and time *",value:W,onChange:n=>{E(n)},slotProps:{textField:{helperText:"First execution time."}}})}),e.jsxs(te,{fullWidth:!0,children:[e.jsx(vt,{variant:"outlined",children:"Recurrence *"}),e.jsxs(xt,{MenuProps:{id:"pp-select-menu"},label:"Recurrence *",value:U,onChange:n=>{$(n.target.value)},children:[e.jsx(ue,{value:"nonrepeating",children:"Only Once (non-repeating)"},"nonrepeating"),...Object.keys(g).map(n=>e.jsx(ue,{value:n,children:g[n].display},n))]}),e.jsx(lt,{children:"How often the event should subsequently recur."})]})]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:s.width<600?"1fr":"1fr 1fr",gap:"20px"},children:[e.jsx(Se,{value:ee,onChange:n=>{ce(n.target.value)},label:"Email",placeholder:"example@domain.com",fullWidth:!0,disabled:!w,helperText:w?e.jsx(e.Fragment,{children:"Enter an email address to receive notifications."}):e.jsx(e.Fragment,{children:"Mail server not available. Configure in Settings > Mail."})}),e.jsx(l,{children:e.jsx(vn,{fullWidth:!0,customInput:Se,value:ge,variant:"outlined",label:"Number of files to keep",onValueChange:({value:n})=>{Number(n)<0?ze(0):ze(Number(n))},onInvalid:n=>{n.preventDefault()},helperText:"Maximum number of export files to keep. Set to 0 to keep all files."})})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"flex-end",alignContent:"center",gap:"10px","& button":{width:"180px"}},children:[e.jsx(_e,{autoFocus:!0,fullWidth:!0,variant:"contained",onClick:n=>{let I=!1;o.length===0?(de(!0),I=!0):de(!1),h.trim()===""?(fe(!0),I=!0):fe(!1),F.trim()===""?(be(!0),I=!0):be(!1),!I&&(W==null?void 0:W.toString().toLowerCase())!=="invalid date"&&ht(),n.stopPropagation()},children:"Schedule"}),e.jsx(_e,{fullWidth:!0,variant:"outlined",onClick:n=>{R(!1),n.stopPropagation()},children:"Cancel"})]})]})]}),bt=()=>e.jsx(l,{sx:{"& thead th":{fontWeight:"bold"}},children:e.jsxs(_t,{children:[e.jsx(Mt,{children:e.jsxs(Ae,{children:[e.jsx(A,{}),e.jsx(A,{children:"Name"}),e.jsx(A,{children:"Scheduled"}),e.jsx(A,{children:"Time"}),e.jsx(A,{children:"Database"}),e.jsx(A,{children:"Tables"}),e.jsx(A,{children:"Drive"}),e.jsx(A,{children:"#Files"}),e.jsx(A,{children:"Email"})]})}),e.jsx(At,{children:b.map(n=>{var I,L,Q,ne,ae,re;return console.debug(n),e.jsxs(Ae,{children:[e.jsx(A,{sx:{width:"30px"},children:e.jsx(pt,{title:"Delete export",children:e.jsx(le,{color:"error",onClick:()=>{gt(n.name),Ze(!0)},children:e.jsx(Zs,{})})})}),e.jsx(A,{children:n.name}),e.jsx(A,{children:(I=g==null?void 0:g[n.schedule])!=null&&I.display?g[n.schedule].display:n.schedule}),e.jsx(A,{children:n.dt}),e.jsx(A,{children:(L=n.params)==null?void 0:L.dbs}),e.jsx(A,{children:(Q=n.params)==null?void 0:Q.tbl}),e.jsx(A,{children:(ne=n.params)==null?void 0:ne.drv}),e.jsx(A,{children:(ae=n.params)==null?void 0:ae.fkp}),e.jsx(A,{children:(re=n.params)==null?void 0:re.eml})]},n.name)})})]})}),Ne=()=>{if(z.length===0)return e.jsx(a.Suspense,{children:e.jsx(Wt,{severity:"warning",message:"No active drives. Activate at least one drive in Settings > Drives.",close:!0})})},yt=()=>Object.keys(C).length===0?e.jsx(l,{children:"There are currently no scheduled exports."}):e.jsx(l,{children:bt()});return e.jsxs(e.Fragment,{children:[e.jsxs(ut,{sx:{marginTop:0,marginBottom:"5px",padding:"20px 10px 20px 24px"},elevation:4,children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingRight:"8px !important",marginBottom:"20px"},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx(Me,{variant:"button",sx:{fontWeight:"bold"},children:"Schedule exports"}),e.jsx(pt,{title:"Schedule new export",position:"bottom",children:e.jsx(le,{onClick:()=>{R(!0)},color:"inherit",disabled:z.length===0,children:e.jsx(Xs,{})})})]}),e.jsx(pt,{title:"Close",position:"bottom",children:e.jsx(le,{onClick:()=>{t(!1)},size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(is,{})})})]}),e.jsx(l,{sx:{display:"grid",gap:"10px",marginRight:"14px",marginBottom:"10px"},children:B||q?e.jsx(a.Suspense,{children:e.jsx(Wt,{severity:"error",message:O,close:!0})}):e.jsxs(e.Fragment,{children:[Ne(),D?jt():yt()]})})]}),Xe&&e.jsx(Pt,{title:"Delete job?",message:e.jsxs("div",{children:["Are you sure you want to delete job ",Ie,"?",e.jsx("br",{}),e.jsx("strong",{children:"This action cannot be undone!"})]}),open:Xe,setOpen:Ze,onConfirm:()=>{It(dt.appUrlExportDelete,{name:Ie}).then(n=>{var I;d.debug("response",n),((I=n==null?void 0:n.data)==null?void 0:I.code)==="ok"?(Be(),oe("Export successfully deleted.",{variant:"success"})):(d.error(n),oe("Invalid response",{variant:"error"}))}).catch(n=>{var I,L;d.error(n),oe(((L=(I=n==null?void 0:n.response)==null?void 0:I.data)==null?void 0:L.message)??(n==null?void 0:n.message)??Z.contactSupport,{variant:"error"})})}})]})},$t=a.lazy(()=>se(()=>import("./Alert-1.0.43-BeyiDeYu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),Fr=()=>{var S;const t=J(),s=a.useRef(null),{search:r,setSearch:i}=Je("ppExplorerSearch"),c=mt(),u=c.database,y=c.error,j=c.selected,C=c.dbsTypes,[x,b]=a.useState("");a.useEffect(()=>{window.ppActionEnableImport=(T=!0)=>{V(T)},window.ppActionEnableExport=(T=!0)=>{P(T)},p()},[]);const p=()=>{let T=[],o="";try{o=localStorage.getItem("ppExplorerSearchDbsTypes")}catch(m){d.debug(m)}o!=null&&o!==""?T=JSON.parse(o):T=[G.WP,G.LOCAL,G.REMOTE],Gt(m=>{const h=m==null?void 0:m.data;d.debug("response data",h);const M=[],F={};h.map(E=>{M.push({dbs:E.dbs,dbsType:E.dbs_type,pdsDbs:E.pds}),F[E.dbs]=!1}),K(F),M.sort((E,U)=>{var $,ee,ce,ge;return(($=E==null?void 0:E.dbs)==null?void 0:$.toLocaleLowerCase())>((ee=U==null?void 0:U.dbs)==null?void 0:ee.toLocaleLowerCase())?1:((ce=U==null?void 0:U.dbs)==null?void 0:ce.toLocaleLowerCase())>((ge=E==null?void 0:E.dbs)==null?void 0:ge.toLocaleLowerCase())?-1:0}),d.debug(M),t(Ms({dbs:M,dbsTypes:T}));const H={};h.map(E=>{H[E.dbs]=E.dbs_type}),t(Ds({dbs:H}));const W=m.context;d.debug("context",W),t(Ls({context:W}))},m=>{d.error("error",m),b(m??Z.contactSupport)})},[g,K]=a.useState({}),[z,v]=a.useState(!0),[w,V]=a.useState(!1),[B,P]=a.useState(!1),q=()=>e.jsx(Ue,{title:"Import data and execute scripts",children:e.jsx(le,{sx:{color:"inherit"},onClick:()=>{V(!w)},children:e.jsx(an,{})})}),f=()=>null,O=()=>e.jsx(le,{onClick:()=>{R(D==="large"?"medium":D==="medium"?"small":"large")},sx:{color:"#fff"},children:D==="small"?e.jsx(tn,{}):D==="medium"?e.jsx(sn,{}):e.jsx(nn,{})});let k="";try{k=localStorage.getItem("ppDataExplorerDensity")}catch(T){d.debug(T)}const[D,R]=a.useState(k==="large"||k==="medium"?k:"small");return a.useEffect(()=>{try{localStorage.setItem("ppDataExplorerDensity",D)}catch(T){d.debug(T)}},[D]),x!==""?e.jsx(a.Suspense,{children:e.jsx($t,{severity:"error",message:x,close:!1})}):e.jsxs(l,{className:"pp-sub-container-explorer",sx:{width:"100%"},children:[e.jsx(ss,{className:"pp-explorer-header",elevation:4,position:"relative",sx:{margin:"0 0 5px 0"},children:e.jsx(ns,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gap:"12px",justifyContent:"space-between",paddingRight:"0 !important"},children:((S=dt.appOrig)==null?void 0:S.appTarget)==="backend"?e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto auto",justifyContent:"end",alignItems:"center",gridGap:"10px"},children:[O(),e.jsx(l,{sx:{textAlign:"right"},children:"Search & Filter"}),e.jsx(Pe,{search:r,setSearch:i,addFilter:!0})]}):e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto 1fr",justifyContent:"space-between",alignItems:"center",gridGap:"10px"},children:[e.jsx(l,{sx:{fontSize:"18px",lineHeight:"18px",fontWeight:"bold",whiteSpace:"nowrap"},children:"Data Explorer"}),e.jsxs(l,{children:[q(),f()]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"end",alignItems:"center",gap:"10px"},children:[O(),e.jsx(Pe,{search:r,setSearch:i,addFilter:!0})]})]})})}),e.jsx(la,{}),w&&e.jsx(ca,{setDoImport:V}),B&&e.jsx(da,{setDoBackup:P}),u==null?e.jsx(l,{sx:{padding:"30px"},children:e.jsx(Os,{title:"Loading..."})}):e.jsxs(e.Fragment,{children:[y!==""&&e.jsx(ut,{sx:{marginBottom:"5px"},elevation:4,children:e.jsx(a.Suspense,{children:e.jsx($t,{severity:"error",message:y,close:!0,setClose:()=>{t(As({error:""}))}})})}),e.jsx(ut,{className:"pp-data-exporer",elevation:4,children:e.jsx(fn,{className:"pp-data-exporer-database-tree pp-density-"+D,"aria-label":"Data Explorer",sx:{"&:first-of-type":{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",overflow:"hidden"},"&:last-of-type":{borderBottomLeftRadius:"4px",borderBottomRightRadius:"4px",overflow:"hidden"}},children:Object.keys(u).map(T=>{var m;if(C.includes(j[T])===!1||r!==""&&!Te(T,r))return null;const o=((m=j[T])==null?void 0:m.toLocaleLowerCase())==="wp"?T+" (WordPress database)":T;return e.jsx(X,{ref:s,slots:{expandIcon:zt,collapseIcon:z?zt:en},itemId:T,className:"pp-data-exporer-database-tree-item hide-details",onClickCapture:h=>{var M,F,H,W;if((M=h.target.closest("li"))!=null&&M.classList.contains("pp-data-exporer-database-tree-item"))if((F=h.target.closest("li"))!=null&&F.classList.contains("hide-details")?((H=h.target.closest("li"))==null||H.classList.remove("hide-details"),v(!1)):((W=h.target.closest("li"))==null||W.classList.add("hide-details"),v(!0)),g[T])h.stopPropagation();else{const E=g;E[T]=!0,K(E)}},sx:{padding:"0","&.hide-details > ul":{visibility:"hidden",position:"fixed"}},label:e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"10px"},children:[e.jsx(Ks,{}),o]}),children:e.jsx(aa,{dbs:T,density:D})},T)})})})]})]})};export{Fr as default};
