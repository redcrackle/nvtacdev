const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./TableContainer-1.0.43-_5zYCHJT.js","./cm-1.0.43-BIThoEwM.js","./redux-1.0.43-X9ShETON.js","./vendor-1.0.43-CN03Eozo.js","./AdminTheme-1.0.43-CqjS-p3h.js","./lib-1.0.43-GM4CAPbj.js","./loglevel-1.0.43-BZ7XahX3.js","./lodash-1.0.43-BGoSrRk7.js","./moment-1.0.43-C5S46NFB.js","./Typography-1.0.43-CjHjtdZs.js","./main-1.0.43.js","./tanstack-1.0.43-B1O1sUTh.js","./FallbackSpinner-1.0.43-SRqLbyxS.js","./Spinner-1.0.43-YmZqinVQ.js","./hooks-1.0.43-Bzf6s8gj.js","./ActionsSettings-1.0.43-DMMuBz79.js","./RestApi-1.0.43-DDknciaN.js","./TargetEnum-1.0.43-CIW1jlU5.js","./Tooltip-1.0.43-dEMLW8-v.js","./Tooltip-1.0.43--D4jr2go.css","./ScopeEnum-1.0.43-B4DDvIDj.js","./index-1.0.43-Lwi8RVeB.js","./iconBase-1.0.43-BkINToSh.js","./useEnhancedEffect-1.0.43-DcXwKdLb.js","./index-1.0.43-Br_nYvvF.js","./notistack-1.0.43-CFZ1B9cW.js","./settings-1.0.43-kDKJ-WYT.js","./ConfirmDialog-1.0.43-HyVPTU5U.js","./Menu-1.0.43-TbmZ3Ge2.js","./ThemeProvider-1.0.43-BdkGbeAu.js","./MenuItem-1.0.43-Uicrp-o6.js","./settings-1.0.43-Bx2jvYL6.css","./useTableUpdater-1.0.43-C8DXp04q.js","./DynamicModeEnum-1.0.43-BXuL5kgA.js","./useFormDetails-1.0.43-D5LxUh_w.js","./useRemoveAppFromStore-1.0.43-BZ2w6e3F.js","./lang-1.0.43-B1WmIuB6.js","./CardContent-1.0.43-B1eq8QmP.js","./TabPanel-1.0.43-BFjnBi0G.js","./useThemeProps-1.0.43-C5lTKcwO.js","./getThemeProps-1.0.43-5uxEwZ_e.js","./Row-1.0.43-DmA2u1uv.js","./useTableSettings-1.0.43-CCERpAbi.js","./useChartSettings-1.0.43-CyXaF5Yk.js","./useStoreTable-1.0.43-L56KWd1n.js","./ActionsDml-1.0.43-CZ8W9C-X.js","./useMetadata-1.0.43-5v27HTeK.js","./useStoreFormSettings-1.0.43-FA6xRyVh.js","./AppTheme-1.0.43-C6ZTpO5w.js","./index-1.0.43-C6_8mZyP.js","./useAppFunctions-1.0.43-CiC-p3-f.js","./useScreenSize-1.0.43-BkaemLwA.js","./dompurify-1.0.43-DhD2mIk-.js","./dayjs.min-1.0.43-B1axidXt.js","./AlertDialog-1.0.43-Der7jh53.js","./SanitizeComponent-1.0.43-DS8pdFaO.js","./Tooltip-1.0.43-Dw3sfo8K.js","./useControlled-1.0.43-DObA-A1B.js","./Popper-1.0.43-8Yb3KIgh.js","./Alert-1.0.43-BeyiDeYu.js","./AlertTitle-1.0.43-CmdM_nv2.js","./createSvgIcon-1.0.43-C8_lU5Lv.js","./Close-1.0.43-DZEA4jNx.js","./Settings-1.0.43-CV23-eFb.js","./TableMapDock-1.0.43-BjHdYs8n.js","./MapPrepare-1.0.43-CGo0KOqr.js","./TableChartDock-1.0.43-YbcnLpuQ.js","./Chart-1.0.43-CHiZoiI3.js"])))=>i.map(i=>d[i]);
import{_ as ie,R as un}from"./main-1.0.43.js";import{j as t}from"./cm-1.0.43-BIThoEwM.js";import{r as l,R as cn}from"./redux-1.0.43-X9ShETON.js";import{l as i,bm as Nt,bk as Vt,bn as At,bl as dn,bo as U,b as mn,w as fn,bp as gn,aY as Ae,S as ue,bq as $e,H as xn,br as _t,bs as jt,bt as Le,g as St,bu as Ge,Z as Ze,bv as Be,A as qe,bw as Ue,W as Lt,a as hn,aW as Qe,bx as wt,X as pn,e as bn,af as _n,_ as jn,by as Sn,bz as wn,bA as Tn,bB as yn}from"./lib-1.0.43-GM4CAPbj.js";import{u as I,a as ye}from"./hooks-1.0.43-Bzf6s8gj.js";import{B as O,S as Ke}from"./Spinner-1.0.43-YmZqinVQ.js";import{a as En}from"./AdminTheme-1.0.43-CqjS-p3h.js";import{u as Ie}from"./useStoreTable-1.0.43-L56KWd1n.js";import{s as Rn,u as Tt,i as yt}from"./ActionsDml-1.0.43-CZ8W9C-X.js";import{e as P}from"./notistack-1.0.43-CFZ1B9cW.js";import{u as Xe}from"./useMetadata-1.0.43-5v27HTeK.js";import"./moment-1.0.43-C5S46NFB.js";import{u as Bt,a as vn}from"./useChartSettings-1.0.43-CyXaF5Yk.js";import{ai as Fn,p as Cn,A as Ut,T as Dt,aj as Et,m as Rt,f as Wt,M as Ht,G as Mn}from"./index-1.0.43-Br_nYvvF.js";import{u as et}from"./useStoreFormSettings-1.0.43-FA6xRyVh.js";import{u as zt,C as On,B as kn}from"./useFormDetails-1.0.43-D5LxUh_w.js";import{a as tt,u as Pn}from"./useRemoveAppFromStore-1.0.43-BZ2w6e3F.js";import{a as Nn,A as Vn,u as An}from"./AppTheme-1.0.43-C6ZTpO5w.js";import{u as Yt}from"./useAppFunctions-1.0.43-CiC-p3-f.js";import{u as $t}from"./useScreenSize-1.0.43-BkaemLwA.js";import{f as Ln,B as ce,C as Bn}from"./ConfirmDialog-1.0.43-HyVPTU5U.js";import"./dompurify-1.0.43-DhD2mIk-.js";import{I as de,P as vt}from"./iconBase-1.0.43-BkINToSh.js";import{d as De}from"./dayjs.min-1.0.43-B1axidXt.js";import{T as Gt}from"./ThemeProvider-1.0.43-BdkGbeAu.js";import{D as re}from"./DynamicModeEnum-1.0.43-BXuL5kgA.js";import{F as Je}from"./FallbackSpinner-1.0.43-SRqLbyxS.js";import{A as Un}from"./AlertDialog-1.0.43-Der7jh53.js";import{S as Ft}from"./SanitizeComponent-1.0.43-DS8pdFaO.js";import{T as Ct}from"./Tooltip-1.0.43-Dw3sfo8K.js";const We=e=>{const s=I(r=>{var u,x;return(x=(u=r.forms[e])==null?void 0:u.state)==null?void 0:x.data});return i.debug("data",s,e),s};var He=(e=>(e[e.SELECT=0]="SELECT",e[e.INSERT=1]="INSERT",e[e.UPDATE=2]="UPDATE",e[e.DELETE=3]="DELETE",e[e.EXPORT=4]="EXPORT",e[e.IMPORT=5]="IMPORT",e[e.VIEW=6]="VIEW",e))(He||{});l.lazy(()=>ie(()=>import("./TableContainer-1.0.43-_5zYCHJT.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]),import.meta.url));l.lazy(()=>ie(()=>import("./TableContainer-1.0.43-_5zYCHJT.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]),import.meta.url));const Jt=e=>4,Dn=e=>{const s=I(r=>{var u;return((u=r.forms[e])==null?void 0:u.columns)??[]});return i.debug("storeColumns",s),s},Mt=e=>{const s=I(r=>r.forms[e]!==void 0?r.forms[e].columns.filter(u=>u.more).length>0:!1);return i.debug("hasMoreColumns",s),s},Wn=e=>{const s=I(r=>{var u,x;return((x=(u=r.forms[e])==null?void 0:u.state)==null?void 0:x.more)??!1});return i.debug("moreState",s),s},Hn=e=>{const s=I(r=>{var u,x;return(x=(u=r.forms[e])==null?void 0:u.state)==null?void 0:x.initialData});return i.debug("initialData",s),s},qt=e=>({}),Qt=e=>(We(e),r=>{}),zn=e=>(ye(),(r,u)=>{}),Yn=(e,s)=>(ye(),(u,x)=>{}),$n=l.lazy(()=>ie(()=>import("./Row-1.0.43-DmA2u1uv.js"),__vite__mapDeps([41,10,1,2,3,5,6,7,8,14,42,43,35,36,13,9,4,44,45,16,25,46,24,22,23,47,34,33,48,49,40,50,51,27,52,53,29,12,54,55,56,57,58]),import.meta.url)),Gn=({appId:e,metaData:s,primaryKey:r,formMode:u,formUuid:x})=>{var A;i.debug(e,s,r,u,x);const T=et(),N=tt(e),S=We(e),w=Hn(e),C=qt(),{app:Q}=Yt(e),D=Qt(e),k=zn(),g=Yn();l.useEffect(()=>{var W;Nt(s)&&((W=C==null?void 0:C.onRowInit)==null?void 0:W.enabled)==!0&&Vt(C.onRowInit.code??"",dn(s),!1,{mode:At[u],getColumnValue:D,setColumnValue:k,setColumnStyle:g,app:Q})},[r]);const[h,y]=l.useState("30px");return l.useEffect(()=>{},[T.spacing]),t.jsx("form",{id:x,className:"pp-form-content",onSubmit:W=>(W.preventDefault(),!1),children:t.jsx(O,{className:"pp-form-grid",sx:{display:"grid",gridTemplateColumns:{lg:`repeat(${T.cellsPerRow}, 1fr)`,md:"repeat("+Math.min(T.cellsPerRow,2)+", 1fr)",xs:"1fr"},gap:h,marginBottom:0,background:T.showGrid?((A=Nn)==null?void 0:A.palette.mode)===mn.LIGHT?"repeating-linear-gradient( -45deg, transparent, transparent 10px, #eee 10px, #eee 20px )":"repeating-linear-gradient( -45deg, transparent, transparent 10px, #111 10px, #111 20px )":"","& p.MuiFormHelperText-root":{...u===U.VIEW&&!0&&{display:"none"}}},children:t.jsx(l.Suspense,{fallback:t.jsx(Ke,{}),children:t.jsx($n,{appId:e,metaData:s,data:S,initialData:w,primaryKey:r,formMode:u,formSettings:T,language:N.language})})})})},Jn=e=>{const s=I(r=>{var u,x;return((x=(u=r.forms[e])==null?void 0:u.state)==null?void 0:x.m2mUpdate)??!1});return i.debug("m2mUpdate",s),s},Xt=cn.memo(({code:e,safeMode:s,isExpression:r,args:u})=>{const x=Vt(e,s,r,u);return window.jQuery&&x instanceof window.jQuery&&x.html(),null}),No=Object.freeze(Object.defineProperty({__proto__:null,default:Xt},Symbol.toStringTag,{value:"Module"})),qn=e=>{const s=I(r=>r.forms[e]);return i.debug("formStore",s),s},Qn=({appId:e,setPrimaryKey:s,tableInstance:r,tableRowIndex:u})=>{i.debug(u);const x=qn(e),[T,N]=l.useState(u),[S,w]=l.useState(0);return l.useEffect(()=>{if(r)if(S===-1){const C=r.getState().pagination.pageSize-1;r!=null&&r.getRowModel().rows[C]&&(N(C),s(C),w(0))}else S===1&&r!=null&&r.getRowModel().rows[0]&&(N(0),s(0),w(0))},[r==null?void 0:r.getState().pagination.pageIndex,r==null?void 0:r.getRowModel().rows]),!x.form.addNavigationButtons||r===void 0||T===void 0?null:t.jsxs(O,{children:[t.jsx(de,{color:"primary",disabled:T===0&&!r.getCanPreviousPage()||S!==0,onClick:()=>{T>0?(N(T-1),s(T-1)):(w(-1),r.previousPage())},children:t.jsx(Fn,{})}),t.jsx(de,{color:"primary",disabled:T+1===r.getRowCount()%r.getState().pagination.pageSize&&!r.getCanNextPage()||S!==0,onClick:()=>{(T+1)%r.getState().pagination.pageSize>0?(N(T+1),s(T+1)):(w(1),r.nextPage())},children:t.jsx(Cn,{})})]})},Ot=l.lazy(()=>ie(()=>import("./Alert-1.0.43-BeyiDeYu.js"),__vite__mapDeps([59,1,2,3,21,22,9,5,6,7,8,23,60,61,62]),import.meta.url)),kt=({appId:e,primaryKey:s,formMode:r,showTable:u,showForm:x,detailKey:T,children:N,relationAppId:S,relTab:w,joinTab:C,isEmbedded:Q,masterAppId:D,isModal:k,tableInstance:g,tableRowIndex:h})=>{var lt,at,ut,ct,dt,mt;i.debug(e,s,r,T,S,w,C,Q,D,k);const y=ye(),A=l.useRef(null),W=Dn(e),j=Bt(e),me=Jt(),H=Ie(e),ee=tt(e),$=qt(),{app:X}=Yt(e);Qt(e);const[te,Z]=l.useState(!1),[G,ne]=l.useState(s),[oe,Ee]=l.useState(r),fe=l.useMemo(()=>fn(),[]),[ze,le]=l.useState(!1),[Re,Ye]=l.useState(""),o=Xe(e),ge=We(e),E=gn((lt=o==null?void 0:o.app)==null?void 0:lt.container[0]),be=Jn(e),z=Xe(D??""),ve=We(D??""),Fe=zt(e),[_e,xe]=l.useState(null);l.useEffect(()=>{i.debug(be,e),be===!0&&(i.debug("setM2MUpdate: false"),se(!1,()=>{},()=>{},()=>{y(_t({appId:e,update:!1})),Z(!0)}))},[be]);const Ce=n=>{var d;const a=(d=g==null?void 0:g.getRowModel().rows[n])==null?void 0:d.original;if(i.debug("setPrimaryKey",a,n),a){const p={...s};Object.keys(s).map(c=>{p[c]=a[c]}),i.debug("newPrimaryKey",p),je(p),ne(p)}};l.useEffect(()=>{s===null?Me():Object.keys(s).length>0?je(s):le(!0)},[s]);const je=n=>{Rn(e,n,o==null?void 0:o.media,a=>{if(i.debug(a),(a==null?void 0:a.code)==="ok"){if(Array.isArray(a.data)&&a.data.length>0){const d={...a.data[0]},p={...a.context};delete p.debug,y($e({appId:e,data:d,context:p})),a.data.length>1?xe("Query returned more than one row. Check configuration."):xe(null)}else{const d={...a.context};delete d.debug,y($e({appId:e,data:{},context:d})),xe("Invalid primary key. Check configuration.")}le(!0)}else P(j.invalidResponse,{variant:"error"})},a=>{i.error("error",a),Ye(a??j.invalidResponse)},!1,w)},Me=()=>{var n,a;if(o.columns&&Array.isArray(o.columns)){const d={},p=Ae.getSelectors().selectFormColumns(ue.getState().forms,e),c=Object.fromEntries(p.map(b=>[b.columnName,b.defaultValue]));i.debug("defaultValues",c);for(let b=0;b<o.columns.length;b++)d[o.columns[b].column_name]=null,c[o.columns[b].column_name]!==void 0&&(c[o.columns[b].column_name]==="@wpda_wp_user_id"?d[o.columns[b].column_name]=(a=(n=o==null?void 0:o.settings)==null?void 0:n.env)==null?void 0:a.id:c[o.columns[b].column_name]==="@now"?o.columns[b]==="date"?d[o.columns[b].column_name]=De(Date.now()).format("YYYY-MM-DD"):d[o.columns[b].column_name]=De(Date.now()).format("YYYY-MM-DD HH:mm:ss"):o.columns[b].column_default!==null&&o.columns[b].column_default!=="NULL"&&o.columns[b].column_default!==""?o.columns[b].column_default==="CURRENT_TIMESTAMP"?o.columns[b]==="date"?d[o.columns[b].column_name]=De(Date.now()).format("YYYY-MM-DD"):d[o.columns[b].column_name]=De(Date.now()).format("YYYY-MM-DD HH:mm:ss"):d[o.columns[b].column_name]=o.columns[b].column_default:d[o.columns[b].column_name]=c[o.columns[b].column_name]);i.debug(d),y($e({appId:e,data:d,context:{media:{}}})),i.debug("init"),le(!0)}},Se=()=>{let n="";for(const a in o.columns)o.columns[a].extra==="auto_increment"&&(n=o.columns[a].column_name);return i.debug(n),n},we=n=>{var b;const a=(b=Ae.getSelectors().selectFormState(ue.getState().forms,e))==null?void 0:b.validation;i.debug("rowValidation",a);let d=!1;for(const f in a)if(a[f].error===!0&&a[f].type===Le.COLUMN){d=!0;break}if(d)return i.debug("validateForm returned errors"),!1;let p=!0;const c=Se();for(const f in n){const m=St(o,f);let v=!0;m.column_name!==c&&m.is_nullable==="NO"&&(n[f]===null||n[f]==="")&&(r===U.UPDATE&&q.preserveSpacesOnUpdate!==!0||r===U.INSERT&&(m.column_default===null||m.column_default==="NULL"||m.column_default===""))&&(y(Ge({appId:e,columnName:f,columnError:!0,columnText:j.mandatoryField,columnType:Le.FORM})),v=!1,p=!1);const F=Ae.getSelectors().selectFormColumns(ue.getState().forms,e);let L;for(let R=0;R<F.length;R++)F[R].columnName===f&&(L=F[R]);if(i.debug(L),v&&m.data_type==="time"){const R=n[f];if(R.length===6){let Y=R.substring(2,3),B=R.substring(4,5);(Number(Y)>5||Number(B)>5)&&(y(Ge({appId:e,columnName:f,columnError:!0,columnText:j.mandatoryField,columnType:Le.FORM})),v=!1,p=!1)}}v&&y(Ge({appId:e,columnName:f,columnError:!1,columnText:"",columnType:Le.FORM}))}return p},Oe=()=>{},Te=n=>{},se=(n,a,d,p)=>{var b;const c=(b=Ae.getSelectors().selectFormState(ue.getState().forms,e))==null?void 0:b.data;if(i.debug(c),Oe()!==!1)if(we(c)){if(G!==null){const f={};Object.keys(c).map(m=>{W.map(v=>{m===v.columnName&&v.updatable&&(f[m]=c[m])})}),i.debug(f),Tt(e,G,f,m=>{var v;if(i.debug(m),m!=null&&m.code&&(m!=null&&m.message)){switch(m.code){case"ok":P(j.updatedSuccessful,{variant:"success"}),Z(!0),((v=m.context)==null?void 0:v.updated)!==void 0&&Object.keys(m.context.updated).map(F=>{y(wt({appId:e,columnName:F,columnValue:m.context.updated[F]}))}),n&&(a!==void 0&&a(G),setTimeout(()=>{u(!0,S)},1e3)),p&&p();break;case"info":P(j.nothingToUpdate,{variant:"info"}),n&&(a!==void 0&&a(G),setTimeout(()=>{u(te,S)},1e3)),p&&p();break;default:i.error(m),P(m.message??j.invalidResponse,{variant:"error"}),n&&u(te,S)}Te(m==null?void 0:m.code)}else i.error(m),P(j.invalidResponse,{variant:"error"})},m=>{i.error("error",m),P(m??j.invalidResponse,{variant:"error"})},!1,C,w)}else y(xn({appId:e,property:{isRowCountUpdated:!0}})),yt(e,c,f=>{if(i.debug(f),f!=null&&f.code&&(f!=null&&f.message)){let m;const v={};switch(f.code){case"ok":P(j.insertSuccessful,{variant:"success"}),Z(!0),m=Se();for(let F=0;F<o.primary_key.length;F++){const L=St(o,o.primary_key[F]);m!==""&&m===(L==null?void 0:L.column_name)?v[o.primary_key[F]]=f.context.insert_id:v[o.primary_key[F]]=c[o.primary_key[F]]}if((E==null?void 0:E.cardinality)===Ue.ONE_TO_ONE){const F={};z!=null&&z.primary_key&&Array.isArray(z==null?void 0:z.primary_key)&&(z==null||z.primary_key.map(R=>F[R]=ve[R]));const L={};if(E.join_condition!==void 0){const R=E.join_condition.split(",");for(let Y=0;Y<R.length;Y++){const B=R[Y].split("=");B.length===2&&(L[B[0]]=v[B[1]])}}Tt(e,F,L,()=>{Object.keys(ve).map(R=>{if(E.join_condition!==void 0){const Y=E.join_condition.split(",");for(let B=0;B<Y.length;B++){const pe=Y[B].split("=");pe.length===2&&pe[0]===R&&D&&y(wt({appId:D,columnName:R,columnValue:ge[pe[1]]}))}}})},()=>{})}if(n){a!==void 0&&a(v),u(!0,S);return}x(v,He.UPDATE),d&&d(),p&&p();break;default:i.error(f),P(f.message??j.invalidResponse,{variant:"error"})}Te(f==null?void 0:f.code)}else i.error(f),P(j.invalidResponse,{variant:"error"})},f=>{i.error("error",f),P(f??j.invalidResponse,{variant:"error"})},!1,C,w);i.debug(S),S!==void 0&&(i.debug("setM2MUpdate: true"),y(_t({appId:S,update:!0})))}else i.error("Validation failed: ",c),P(j.inputError,{variant:"error"})},ke=()=>_e===null?null:t.jsx(l.Suspense,{children:t.jsx(O,{sx:{marginTop:"30px"},children:t.jsx(Ot,{severity:"error",message:_e,close:!1})})}),Pe=n=>{if(n!==null&&we(ge)){const a=Qe.getSelectors().selectTableById(ue.getState().tables,e),d=a.state.relation.relation_join_condition.split(",").map(c=>c.split("=")),p={...a.state.detailKey};d.map(c=>{p[c[0]]=n[c[1]]}),yt(e,p,c=>{if(i.debug(c),c!=null&&c.code&&(c!=null&&c.message))switch(c.code){case"ok":i.debug("Added relation to join table",c);break;default:i.error(c),P(c.message??j.invalidResponse,{variant:"error"})}else i.error(c),P(j.invalidResponse,{variant:"error"})},c=>{i.error(c),P(c??j.invalidResponse,{variant:"error"})},!1,!0,!1)}},[Ne,Ve]=l.useState(void 0),_=()=>{try{se(!1,()=>{},()=>{var a,d,p,c,b,f,m,v,F,L,R,Y,B,pe,ft,gt,xt,ht,pt,bt;const n=JSON.parse((d=(a=o==null?void 0:o.app)==null?void 0:a.app[0])==null?void 0:d.app_settings);if(i.debug(n),((c=(p=n==null?void 0:n.settings)==null?void 0:p.app_registration)==null?void 0:c.showMessage)===!0&&((f=(b=n==null?void 0:n.settings)==null?void 0:b.app_registration)==null?void 0:f.message)!==void 0&&((v=(m=n==null?void 0:n.settings)==null?void 0:m.app_registration)==null?void 0:v.message)!==null&&((L=(F=n==null?void 0:n.settings)==null?void 0:F.app_registration)==null?void 0:L.message.trim())!==""&&Ve((Y=(R=n==null?void 0:n.settings)==null?void 0:R.app_registration)==null?void 0:Y.message),((pe=(B=n==null?void 0:n.settings)==null?void 0:B.app_registration)==null?void 0:pe.allowUpdates)!==!0&&(Ee(U.VIEW),((gt=(ft=n==null?void 0:n.settings)==null?void 0:ft.app_registration)==null?void 0:gt.showUrl)===!0&&((ht=(xt=n==null?void 0:n.settings)==null?void 0:xt.app_registration)==null?void 0:ht.url)!=="")){const an=((bt=(pt=n==null?void 0:n.settings)==null?void 0:pt.app_registration)==null?void 0:bt.urlTime)??3;setTimeout(()=>{window.location.href=n.settings.app_registration.url},an)}})}catch(n){i.error("Invalid JSON - app settings"),i.error(n),P(hn.contactSupport,{variant:"error"})}},M=()=>{se(!1)},J=()=>{var a,d,p;const n=Qe.getSelectors().selectTableById(ue.getState().tables,e);i.debug((a=n==null?void 0:n.state)==null?void 0:a.relation),((p=(d=n==null?void 0:n.state)==null?void 0:d.relation)==null?void 0:p.cardinality)===Ue.MANY_TO_MANY?se(!0,Pe):se(!0)},V=()=>{u(te,S)},q=et(),Zt=Mt(e),Kt=Mt(S??""),ae=Wn(e),K=l.useRef(null),It=$t(),[he,en]=l.useState((at=K==null?void 0:K.current)==null?void 0:at.offsetWidth),[tn,nn]=l.useState({paddingTop:"50px",paddingBottom:"50px",paddingLeft:"50px",paddingRight:"50px"}),[on,nt]=l.useState("30px"),[sn,ot]=l.useState("");if(l.useEffect(()=>{if(K.current!==null){en(K.current.offsetWidth);let n=he<600?.3:he<900?.6:1;(k??!1)===!0&&(n=1),nn({paddingTop:`calc(${n} * 50px)`,paddingBottom:`calc(${n} * 50px)`,paddingLeft:`calc(${n} * 50px)`,paddingRight:`calc(${n} * 50px)`}),he<600?(nt("10px"),ot("10px")):he<900&&(nt("20px"),ot("20px"))}},[It.width,K.current,q.spacing]),Re!=="")return t.jsx(l.Suspense,{children:t.jsx(Ot,{severity:"error",message:Re,close:!1})});const st=()=>t.jsx(Gn,{appId:e,metaData:o,primaryKey:G,formMode:oe,formUuid:fe}),rn=()=>t.jsxs(t.Fragment,{children:[t.jsx(de,{color:"inherit",onClick:()=>{const n={appId:e};i.debug(E),E!=null&&(n.hideThemeSettings=!0),S!==void 0&&(n.isRelationForm=!0),y(Lt(n))},children:t.jsx(Wt,{})}),t.jsx(de,{color:"inherit",onClick:()=>{V()},children:t.jsx(Ht,{})})]}),ln=l.useMemo(()=>{var n,a,d,p,c;return(n=o==null?void 0:o.src)!=null&&n.app_id&&((d=(a=o==null?void 0:o.app)==null?void 0:a.app[0])==null?void 0:d.app_title)!==""?o.app.app[0].app_title:(p=o==null?void 0:o.src)!=null&&p.dbs&&((c=o==null?void 0:o.src)!=null&&c.tbl)?o.src.dbs+" - "+o.src.tbl:"WP Data Access"},[]),rt=(((ct=(ut=H==null?void 0:H.table)==null?void 0:ut.modal)==null?void 0:ct.maxHeight)??95)+(((mt=(dt=H==null?void 0:H.table)==null?void 0:dt.modal)==null?void 0:mt.maxHeightUnit)??"vh"),it=()=>{var n,a,d;return t.jsxs(vt,{elevation:me,ref:A,children:[(k??!1)===!0&&t.jsx(Ut,{sx:{position:"unset",borderBottomRightRadius:0,borderBottomLeftRadius:0,boxShadow:"none"},children:t.jsxs(Dt,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(O,{sx:{display:"flex",alignItems:"center",cursor:"move",gap:"2px","& svg":{width:"2em",height:"2em"}},id:jt(o,"title"),children:t.jsx(O,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:ln})}),t.jsx(O,{children:(k??!1)===!0&&Ze(o)&&t.jsx(t.Fragment,{children:rn()})})]})}),t.jsxs(O,{style:tn,sx:{...(k??!1)===!0&&Fe!==void 0&&{maxHeight:`calc(${rt} - 240px)`,overflow:"auto",backgroundColor:"transparent",border:"none",borderRadius:0}},children:[t.jsxs(O,{sx:{margin:0,padding:"5px 0",...(k??!1)===!0&&Fe===void 0&&{maxHeight:`calc(${rt} - 240px)`,overflow:"auto"}},children:[st(),N,ke()]}),t.jsxs(O,{sx:{marginTop:{marginTop:on},paddingRight:{paddingRight:sn},padding:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(O,{sx:{display:"flex",gap:"8px"},children:[s!=null&&Object.keys(s).length>0&&t.jsx(Qn,{appId:e,tableInstance:g,tableRowIndex:h,setPrimaryKey:Ce}),!1,(Zt||Kt)&&t.jsx(t.Fragment,{children:he<600?t.jsx(de,{color:"primary",onClick:()=>{y(Be({appId:e,more:!ae})),S!==void 0&&y(Be({appId:S,more:!ae}))},children:ae?t.jsx(Et,{}):t.jsx(Rt,{})}):t.jsx(ce,{variant:"outlined",startIcon:ae?t.jsx(Et,{}):t.jsx(Rt,{}),onClick:()=>{y(Be({appId:e,more:!ae})),S!==void 0&&y(Be({appId:S,more:!ae}))},children:ae?j.less:j.more})}),((n=$==null?void 0:$.customActionsBottom)==null?void 0:n.enabled)===!0&&Nt(o)&&t.jsx(t.Fragment,{children:t.jsx(Xt,{code:$.customActionsBottom.code??"",safeMode:ee.safeMode,isExpression:!1,args:{row:ge,mode:At[r],app:X}})}),t.jsx(O,{className:"pp-registration-form-message",children:Ne})]}),t.jsx(O,{sx:{...he<600&&{marginLeft:"0 !important","& button":{marginLeft:"2px",padding:"6px"}}},children:r!==U.VIEW?t.jsx(t.Fragment,{children:((d=(a=o==null?void 0:o.app)==null?void 0:a.app[0])==null?void 0:d.app_type)==qe.REGISTRATION&&H.state.masterDetailConditions===void 0?t.jsx(t.Fragment,{children:(oe===U.INSERT||oe===U.UPDATE)&&t.jsx(ce,{variant:"contained",onClick:_,type:"submit",form:fe,sx:{marginLeft:"8px"},children:j.ok})}):t.jsxs(t.Fragment,{children:[t.jsx(ce,{variant:"contained",onClick:M,type:"submit",form:fe,disabled:_e!==null,children:j.apply}),(E==null?void 0:E.cardinality)!==Ue.ONE_TO_ONE&&t.jsxs(t.Fragment,{children:[t.jsx(ce,{variant:"outlined",onClick:J,sx:{marginLeft:"8px"},children:j.ok}),t.jsx(ce,{variant:"outlined",onClick:V,sx:{marginLeft:"8px"},children:j.cancel})]})]})}):t.jsx(t.Fragment,{children:(E==null?void 0:E.cardinality)!==Ue.ONE_TO_ONE&&t.jsx(ce,{variant:"contained",onClick:V,children:j.back})})})]}),t.jsx(t.Fragment,{children:!1})]})]})};return Q?st():(l.useEffect(()=>{var n;K.current!==null&&((n=window.document.getElementById(`pp-app-${e}`))==null||n.scrollIntoView())},[K.current]),t.jsx("div",{className:`${e}_wrapper pp-form`,ref:K,style:{scrollMarginTop:"70px"},children:ze&&ge!==null?t.jsx(t.Fragment,{children:(k??!1)===!0?t.jsx(t.Fragment,{children:t.jsx(Ln,{handle:"#"+jt(o,"title"),nodeRef:A,offsetParent:document.body,children:it()})}):t.jsx(t.Fragment,{children:it()})}):t.jsx(vt,{style:{padding:"50px"},elevation:me,children:t.jsx(Ke,{title:j.loadingData})})}))},Xn=l.lazy(()=>ie(()=>import("./Settings-1.0.43-CV23-eFb.js"),__vite__mapDeps([63,10,1,2,3,5,6,7,8,14,4,9,15,16,17,20,25,18,19,21,22,23,24,26,13,27,28,29,30,31,46,33,37,38,39,40,44,45,43,35,36,47,34,48,49,50,51,52,53,12,54,55,56,57,58]),import.meta.url)),Pt=({appId:e,primaryKey:s,formMode:r,showTable:u,showForm:x,metaData:T,detailKey:N,selectionForm:S,masterAppId:w,tableInstance:C,tableRowIndex:Q})=>{i.debug(e,s,r,T,N,S,w);const D=En(),g=Ie(e).table;i.debug("relationship",null);const y=l.useMemo(()=>{},[]);i.debug("relationAppId",y);const A=()=>null,W=()=>null,j=()=>null,me=()=>{var ee,$,X,te,Z,G,ne,oe;return t.jsx(Mn,{open:!0,className:"pp-form-modal",sx:{zIndex:9999990},children:t.jsx(O,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:(((ee=g==null?void 0:g.modal)==null?void 0:ee.minWidth)??60)+((($=g==null?void 0:g.modal)==null?void 0:$.minWidthUnit)??"vw"),maxWidth:(((X=g==null?void 0:g.modal)==null?void 0:X.maxWidth)??90)+(((te=g==null?void 0:g.modal)==null?void 0:te.maxWidthUnit)??"vw"),minHeight:(((Z=g==null?void 0:g.modal)==null?void 0:Z.minHeight)??0)+(((G=g==null?void 0:g.modal)==null?void 0:G.minHeightUnit)??"vh"),maxHeight:(((ne=g==null?void 0:g.modal)==null?void 0:ne.maxHeight)??95)+(((oe=g==null?void 0:g.modal)==null?void 0:oe.maxHeightUnit)??"vh"),backgroundColor:"transparent"},children:t.jsx(kt,{appId:e,primaryKey:s,formMode:r,showTable:u,showForm:x,detailKey:N,relationAppId:y,masterAppId:w,isModal:!0,tableInstance:C,tableRowIndex:Q,children:W()})})})},H=()=>t.jsx(kt,{appId:e,primaryKey:s,formMode:r,showTable:u,showForm:x,detailKey:N,relationAppId:y,masterAppId:w,tableInstance:C,tableRowIndex:Q,children:W()});return t.jsxs(t.Fragment,{children:[S===!0?t.jsx(t.Fragment,{children:A()}):t.jsx(t.Fragment,{children:g.formModal===!0?t.jsx(t.Fragment,{children:me()}):t.jsx(t.Fragment,{children:H()})}),t.jsx(t.Fragment,{children:Ze(T)&&t.jsx(Gt,{theme:D,children:t.jsx(l.Suspense,{fallback:t.jsx(Ke,{}),children:t.jsx(Xn,{appId:e})})})}),j()]})},Zn=e=>{const s=I(r=>{var u,x;return((x=(u=r.tables[e])==null?void 0:u.state)==null?void 0:x.fullScreen)??!1});return i.debug("fullScreen",s),s},Kn=()=>{const e=I(s=>s.ui);return i.debug("uiSetting",e),e},In=e=>(ye(),{builtinLog:e,builtinShowAlert:(x,T)=>{},builtinShowConfirm:(x,T,N)=>{},builtinShowSnackbar:(x,T)=>{}}),eo=({label:e})=>t.jsx(ce,{variant:"contained",color:"primary",children:e}),to=l.lazy(()=>ie(()=>import("./TableContainer-1.0.43-_5zYCHJT.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]),import.meta.url));l.lazy(()=>ie(()=>import("./TableMapDock-1.0.43-BjHdYs8n.js"),__vite__mapDeps([64,1,2,3,65,10,5,6,7,8,46,14,25,12,13,9,22,23]),import.meta.url));l.lazy(()=>ie(()=>import("./TableChartDock-1.0.43-YbcnLpuQ.js"),__vite__mapDeps([66,1,2,3,67,10,5,6,7,8,43,35,36,14,13,9,24,22,23,25,56,29,57,58,46,48,49,40]),import.meta.url));const no=({appId:e})=>{var xe,Ce,je,Me,Se,we,Oe,Te,se,ke,Pe,Ne,Ve;i.debug(e);const s=ye(),r=Pn(),u=On(),x=Jt(),T=zt(e);vn(e);const S=Ie(e).table,w=Kn();$t();const C=et(),Q=An(),D=Vn(Q,S,C),k=Bt(e),g="pp-remove-body-vertical-scrollbar",h=Xe(e),y=()=>{var _,M,J,V,q;return(_=h==null?void 0:h.src)!=null&&_.app_id&&((J=(M=h==null?void 0:h.app)==null?void 0:M.app[0])==null?void 0:J.app_title)!==""?h.app.app[0].app_title:(V=h==null?void 0:h.src)!=null&&V.dbs&&((q=h==null?void 0:h.src)!=null&&q.tbl)?h.src.dbs+" - "+h.src.tbl:"WP Data Access"},A=`_reactRoots_${e.replaceAll("-","_")}`;l.useEffect(()=>()=>{window[A]&&delete window[A]},[]);const{builtinLog:W,builtinShowAlert:j,builtinShowConfirm:me,builtinShowSnackbar:H}=In(i);window.wpda={log:W,alert:j,confirm:me,snackbar:H,button:(_,M)=>{window.document.querySelectorAll(`#${_}`).forEach(J=>{const V=window[A]||new Map;window[A]=V;let q=V.get(J);q||(q=un.createRoot(J),V.set(J,q)),q.render(t.jsx(Gt,{theme:l.useMemo(()=>D,[]),children:t.jsx(eo,{label:M})}))})}};const ee=Zn(e);l.useEffect(()=>(i.debug(ee),()=>{var _;(_=window.document.getElementById(g))==null||_.remove(),window.document.body.classList.remove("pp-fullscreen")}),[ee]);const $=l.useMemo(()=>Qe.getSelectors().selectTableExploring(ue.getState().tables,e),[e]);i.debug("tableExploring",$);const[X,te]=l.useState(((Ce=(xe=h==null?void 0:h.app)==null?void 0:xe.app[0])==null?void 0:Ce.app_type)==qe.REGISTRATION?re.FORM:re.TABLE),[Z,G]=l.useState(!1),ne=_=>{s(Tn({appId:e,mode:_})),te(_)};l.useEffect(()=>{window.ppShowForm=function(_){i.debug(_),fe(_),ne(re.FORM)}},[e]);const oe=(_,M)=>{i.debug(_,M),yn(e)&&(u(e),M!==void 0&&(r(M),u(M))),_&&G(!Z),ne(re.TABLE)},[Ee,fe]=l.useState(null),[ze,le]=l.useState(U.VIEW),[Re,Ye]=l.useState(void 0),[o,ge]=l.useState(void 0),E=(_,M,J,V)=>{switch(i.debug(_,M,V),M){case He.INSERT:le(U.INSERT);break;case He.UPDATE:le(U.UPDATE);break;default:le(U.VIEW)}fe(_),Ye(J),ge(V),ne(re.FORM)};let be={};tt(e);const[z]=l.useState(((Se=window.PP_APP_CONFIG[(Me=(je=h==null?void 0:h.app)==null?void 0:je.app[0])==null?void 0:Me.app_id])==null?void 0:Se.hideTitleBar)===!0),ve=()=>null,Fe=()=>t.jsx(l.Suspense,{fallback:t.jsx(Je,{title:k.loadingForm}),children:t.jsx(Pt,{appId:e,primaryKey:Ee,formMode:U.INSERT,showTable:()=>{},showForm:E,metaData:h})}),_e=()=>{var _,M;return((M=(_=h==null?void 0:h.app)==null?void 0:_.app[0])==null?void 0:M.app_type)==qe.REGISTRATION?Fe():t.jsxs(t.Fragment,{children:[t.jsxs(l.Suspense,{fallback:t.jsx(Je,{title:k.loadingTable}),children:[!1,t.jsx(to,{appId:e,display:X===re.TABLE,refresh:Z,showForm:E,metaData:h}),!1]}),X===re.FORM&&t.jsx(l.Suspense,{fallback:t.jsx(Je,{title:k.loadingForm}),children:t.jsx(Pt,{appId:e,primaryKey:Ee,formMode:ze,showTable:oe,showForm:E,metaData:h,tableInstance:Re,tableRowIndex:o})})]})};return t.jsxs(O,{className:"pp-component",sx:ee?be:{},children:[z!==!0&&t.jsx(Ut,{className:"pp-header",elevation:x,position:"relative",sx:{margin:"0 0 5px 0"},children:t.jsxs(Dt,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(O,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:y()}),t.jsxs(O,{sx:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[Ze(h)&&t.jsx(Ct,{title:t.jsx(kn,{details:T,mode:X}),className:"pp-builder-button",children:t.jsx(de,{sx:{color:"inherit",padding:0},onClick:()=>{X===re.FORM?s(Lt({appId:e})):s(pn({appId:e}))},children:t.jsx(Wt,{})})}),ve(),$&&t.jsx(Ct,{title:k.close,children:t.jsx(de,{sx:{color:"inherit",padding:0},onClick:()=>{var _;(_=window.document.getElementById(g))==null||_.remove(),window.document.body.classList.remove("pp-fullscreen"),h.src.app_id?s(bn({isActive:!1,appDbId:0})):s(_n()),u(e),r(e),s(jn())},children:t.jsx(Ht,{})})})]})]})}),_e(),((we=w.builtins.alert)==null?void 0:we.title)&&((Oe=w.builtins.alert)==null?void 0:Oe.message)&&t.jsx(Un,{title:(Te=w.builtins.alert)==null?void 0:Te.title,message:t.jsx(Ft,{html:(se=w.builtins.alert)==null?void 0:se.message}),open:!0,setOpen:()=>{s(Sn())}}),((ke=w.builtins.confirm)==null?void 0:ke.title)&&((Pe=w.builtins.confirm)==null?void 0:Pe.message)&&t.jsx(Bn,{title:(Ne=w.builtins.confirm)==null?void 0:Ne.title,message:t.jsx(Ft,{html:(Ve=w.builtins.confirm)==null?void 0:Ve.message}),open:!0,setOpen:()=>{s(wn())},onConfirm:()=>{var _;(_=w.builtins.confirm)!=null&&_.callback&&w.builtins.confirm.callback()}})]})},Vo=Object.freeze(Object.defineProperty({__proto__:null,default:no},Symbol.toStringTag,{value:"Module"}));export{No as D,He as R,Vo as S,Dn as a,Wn as b,Zn as c,Jt as d,qt as e,We as f,Qt as g,zn as h,Yn as i,qn as u};
