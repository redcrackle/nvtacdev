const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Alert-1.0.43-BeyiDeYu.js","./cm-1.0.43-BIThoEwM.js","./redux-1.0.43-X9ShETON.js","./vendor-1.0.43-CN03Eozo.js","./index-1.0.43-Lwi8RVeB.js","./iconBase-1.0.43-BkINToSh.js","./Typography-1.0.43-CjHjtdZs.js","./lib-1.0.43-GM4CAPbj.js","./loglevel-1.0.43-BZ7XahX3.js","./lodash-1.0.43-BGoSrRk7.js","./moment-1.0.43-C5S46NFB.js","./useEnhancedEffect-1.0.43-DcXwKdLb.js","./AlertTitle-1.0.43-CmdM_nv2.js","./createSvgIcon-1.0.43-C8_lU5Lv.js","./Close-1.0.43-DZEA4jNx.js","./Settings-1.0.43-Cn5CreJr.js","./main-1.0.43.js","./hooks-1.0.43-Bzf6s8gj.js","./settings-1.0.43-kDKJ-WYT.js","./index-1.0.43-Br_nYvvF.js","./notistack-1.0.43-CFZ1B9cW.js","./Spinner-1.0.43-YmZqinVQ.js","./ConfirmDialog-1.0.43-HyVPTU5U.js","./AdminTheme-1.0.43-CqjS-p3h.js","./Menu-1.0.43-TbmZ3Ge2.js","./ThemeProvider-1.0.43-BdkGbeAu.js","./MenuItem-1.0.43-Uicrp-o6.js","./settings-1.0.43-Bx2jvYL6.css","./Tooltip-1.0.43-dEMLW8-v.js","./Tooltip-1.0.43--D4jr2go.css","./ActionsSettings-1.0.43-DMMuBz79.js","./RestApi-1.0.43-DDknciaN.js","./TargetEnum-1.0.43-CIW1jlU5.js","./useMapUpdater-1.0.43-CWbe2ro7.js","./DynamicModeEnum-1.0.43-BXuL5kgA.js","./CardContent-1.0.43-B1eq8QmP.js","./TabPanel-1.0.43-BFjnBi0G.js","./useThemeProps-1.0.43-C5lTKcwO.js","./getThemeProps-1.0.43-5uxEwZ_e.js"])))=>i.map(i=>d[i]);
import{_ as ye}from"./main-1.0.43.js";import{j as f}from"./cm-1.0.43-BIThoEwM.js";import{r as a,R as k}from"./redux-1.0.43-X9ShETON.js";import{r as be,e as $}from"./notistack-1.0.43-CFZ1B9cW.js";import{g as Re}from"./vendor-1.0.43-CN03Eozo.js";import{a5 as ze,l as I,aa as Fe,e as Be,ab as De,_ as Ue,a9 as He,t as Ge,Z as Ze,C as $e,a8 as Je,ac as F,ad as qe}from"./lib-1.0.43-GM4CAPbj.js";import{u as Ke,a as Ce}from"./hooks-1.0.43-Bzf6s8gj.js";import{a as Ve}from"./AdminTheme-1.0.43-CqjS-p3h.js";import{a as We}from"./RestApi-1.0.43-DDknciaN.js";import"./dompurify-1.0.43-DhD2mIk-.js";import"./moment-1.0.43-C5S46NFB.js";import{u as Ye}from"./useMetadata-1.0.43-5v27HTeK.js";import{u as Xe,a as Qe,L as et}from"./useRemoveAppFromStore-1.0.43-BZ2w6e3F.js";import{A as tt,T as Me,f as nt,M as rt}from"./index-1.0.43-Br_nYvvF.js";import{B as W,S as ot}from"./Spinner-1.0.43-YmZqinVQ.js";import{T as ce}from"./Tooltip-1.0.43-Dw3sfo8K.js";import{I as de}from"./iconBase-1.0.43-BkINToSh.js";import{F as it}from"./FallbackSpinner-1.0.43-SRqLbyxS.js";import{A as at,u as st}from"./AppTheme-1.0.43-C6ZTpO5w.js";import{a as lt}from"./index-1.0.43-CEsXajp3.js";import{S as ut}from"./Select-1.0.43-CISjJoqC.js";import{M as ct}from"./MenuItem-1.0.43-Uicrp-o6.js";import{T as dt,a as fe}from"./ToggleButtonGroup-1.0.43-y6Kkgg0C.js";import{g as ft}from"./tab-1.0.43-6bV41ZmB.js";import{T as me}from"./ThemeProvider-1.0.43-BdkGbeAu.js";import"./loglevel-1.0.43-BZ7XahX3.js";import"./lodash-1.0.43-BGoSrRk7.js";import"./Typography-1.0.43-CjHjtdZs.js";import"./lang-1.0.43-B1WmIuB6.js";import"./useEnhancedEffect-1.0.43-DcXwKdLb.js";import"./useControlled-1.0.43-DObA-A1B.js";import"./Popper-1.0.43-8Yb3KIgh.js";import"./index-1.0.43-C6_8mZyP.js";import"./getThemeProps-1.0.43-5uxEwZ_e.js";import"./Menu-1.0.43-TbmZ3Ge2.js";import"./utils-1.0.43-iop7lDec.js";import"./useFormControl-1.0.43-D7bmEJOO.js";import"./createSvgIcon-1.0.43-C8_lU5Lv.js";var V,ge;function mt(){return ge||(ge=1,V=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var o,s,r;if(Array.isArray(e)){if(o=e.length,o!=n.length)return!1;for(s=o;s--!==0;)if(!t(e[s],n[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(r=Object.keys(e),o=r.length,o!==Object.keys(n).length)return!1;for(s=o;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,r[s]))return!1;for(s=o;s--!==0;){var i=r[s];if(!t(e[i],n[i]))return!1}return!0}return e!==e&&n!==n}),V}var gt=mt();const pt=Re(gt);function P(){return P=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)({}).hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},P.apply(null,arguments)}function B(t,e){if(t==null)return{};var n={};for(var o in t)if({}.hasOwnProperty.call(t,o)){if(e.indexOf(o)!==-1)continue;n[o]=t[o]}return n}function ht(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function vt(t){var e=ht(t,"string");return typeof e=="symbol"?e:e+""}const z={NOT_LOADED:"NOT_LOADED",LOADING:"LOADING",LOADED:"LOADED",FAILED:"FAILED",AUTH_FAILURE:"AUTH_FAILURE"},yt="https://maps.googleapis.com/maps/api/js";class H{static async load(e,n){var o;const s=e.libraries?e.libraries.split(","):[],r=this.serializeParams(e);this.listeners.push(n),(o=window.google)!=null&&(o=o.maps)!=null&&o.importLibrary?(this.serializedApiParams||(this.loadingStatus=z.LOADED),this.notifyLoadingStatusListeners()):(this.serializedApiParams=r,this.initImportLibrary(e)),this.serializedApiParams&&this.serializedApiParams!==r&&console.warn("[google-maps-api-loader] The maps API has already been loaded with different parameters and will not be loaded again. Refresh the page for new values to have effect.");const i=["maps",...s];await Promise.all(i.map(l=>google.maps.importLibrary(l)))}static serializeParams(e){return[e.v,e.key,e.language,e.region,e.authReferrerPolicy,e.solutionChannel].join("/")}static initImportLibrary(e){if(window.google||(window.google={}),window.google.maps||(window.google.maps={}),window.google.maps.importLibrary){console.error("[google-maps-api-loader-internal]: initImportLibrary must only be called once");return}let n=null;const o=()=>n||(n=new Promise((s,r)=>{var i;const l=document.createElement("script"),c=new URLSearchParams;for(const[m,g]of Object.entries(e)){const y=m.replace(/[A-Z]/g,v=>"_"+v[0].toLowerCase());c.set(y,String(g))}c.set("loading","async"),c.set("callback","__googleMapsCallback__"),l.async=!0,l.src=yt+"?"+c.toString(),l.nonce=((i=document.querySelector("script[nonce]"))==null?void 0:i.nonce)||"",l.onerror=()=>{this.loadingStatus=z.FAILED,this.notifyLoadingStatusListeners(),r(new Error("The Google Maps JavaScript API could not load."))},window.__googleMapsCallback__=()=>{this.loadingStatus=z.LOADED,this.notifyLoadingStatusListeners(),s()},window.gm_authFailure=()=>{this.loadingStatus=z.AUTH_FAILURE,this.notifyLoadingStatusListeners()},this.loadingStatus=z.LOADING,this.notifyLoadingStatusListeners(),document.head.append(l)}),n);google.maps.importLibrary=s=>o().then(()=>google.maps.importLibrary(s))}static notifyLoadingStatusListeners(){for(const e of this.listeners)e(this.loadingStatus)}}H.loadingStatus=z.NOT_LOADED;H.serializedApiParams=void 0;H.listeners=[];const bt=["onLoad","onError","apiKey","version","libraries"],Ct=["children"],Mt="GMP_visgl_rgmlibrary_v1_default",G=k.createContext(null);function Lt(){const[t,e]=a.useState({});return{mapInstances:t,addMapInstance:(r,i="default")=>{e(l=>P({},l,{[i]:r}))},removeMapInstance:(r="default")=>{e(i=>B(i,[r].map(vt)))},clearMapInstances:()=>{e({})}}}function kt(t){const{onLoad:e,onError:n,apiKey:o,version:s,libraries:r=[]}=t,i=B(t,bt),[l,c]=a.useState(H.loadingStatus),[m,g]=a.useReducer((d,b)=>d[b.name]?d:P({},d,{[b.name]:b.value}),{}),y=a.useMemo(()=>r==null?void 0:r.join(","),[r]),v=a.useMemo(()=>JSON.stringify(P({apiKey:o,version:s},i)),[o,s,i]),h=a.useCallback(async d=>{var b;if(m[d])return m[d];if(!((b=google)!=null&&(b=b.maps)!=null&&b.importLibrary))throw new Error("[api-provider-internal] importLibrary was called before google.maps.importLibrary was defined.");const M=await window.google.maps.importLibrary(d);return g({name:d,value:M}),M},[m]);return a.useEffect(()=>{(async()=>{try{const d=P({key:o},i);s&&(d.v=s),(y==null?void 0:y.length)>0&&(d.libraries=y),(d.channel===void 0||d.channel<0||d.channel>999)&&delete d.channel,d.solutionChannel===void 0?d.solutionChannel=Mt:d.solutionChannel===""&&delete d.solutionChannel,await H.load(d,b=>c(b));for(const b of["core","maps",...r])await h(b);e&&e()}catch(d){n?n(d):console.error("<ApiProvider> failed to load the Google Maps JavaScript API",d)}})()},[o,y,v]),{status:l,loadedLibraries:m,importLibrary:h}}const xt=t=>{const{children:e}=t,n=B(t,Ct),{mapInstances:o,addMapInstance:s,removeMapInstance:r,clearMapInstances:i}=Lt(),{status:l,loadedLibraries:c,importLibrary:m}=kt(n),g=a.useMemo(()=>({mapInstances:o,addMapInstance:s,removeMapInstance:r,clearMapInstances:i,status:l,loadedLibraries:c,importLibrary:m}),[o,s,r,i,l,c,m]);return k.createElement(G.Provider,{value:g},e)};function Et(t,e){for(const n of At){const o=e[n],s=Le[n];a.useEffect(()=>{if(!t||!o)return;const r=google.maps.event.addListener(t,s,i=>{o(It(s,t,i))});return()=>r.remove()},[t,s,o])}}function It(t,e,n){const o={type:t,map:e,detail:{},stoppable:!1,stop:()=>{}};if(Ot.includes(t)){const r=o,i=e.getCenter(),l=e.getZoom(),c=e.getHeading()||0,m=e.getTilt()||0,g=e.getBounds();return(!i||!g||!Number.isFinite(l))&&console.warn("[createEvent] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),r.detail={center:(i==null?void 0:i.toJSON())||{lat:0,lng:0},zoom:l||0,heading:c,tilt:m,bounds:(g==null?void 0:g.toJSON())||{north:90,east:180,south:-90,west:-180}},r}else if(_t.includes(t)){var s;if(!n)throw new Error("[createEvent] mouse events must provide a srcEvent");const r=o;return r.domEvent=n.domEvent,r.stoppable=!0,r.stop=()=>n.stop(),r.detail={latLng:((s=n.latLng)==null?void 0:s.toJSON())||null,placeId:n.placeId},r}return o}const Le={onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onContextmenu:"contextmenu",onDblclick:"dblclick",onDrag:"drag",onDragend:"dragend",onDragstart:"dragstart",onHeadingChanged:"heading_changed",onIdle:"idle",onIsFractionalZoomEnabledChanged:"isfractionalzoomenabled_changed",onMapCapabilitiesChanged:"mapcapabilities_changed",onMapTypeIdChanged:"maptypeid_changed",onMousemove:"mousemove",onMouseout:"mouseout",onMouseover:"mouseover",onProjectionChanged:"projection_changed",onRenderingTypeChanged:"renderingtype_changed",onTilesLoaded:"tilesloaded",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed",onCameraChanged:"bounds_changed"},Ot=["bounds_changed","center_changed","heading_changed","tilt_changed","zoom_changed"],_t=["click","contextmenu","dblclick","mousemove","mouseout","mouseover"],At=Object.keys(Le);function St(t,e){const n=a.useRef(void 0);(!n.current||!pt(e,n.current))&&(n.current=e),a.useEffect(t,n.current)}const wt=new Set(["backgroundColor","clickableIcons","controlSize","disableDefaultUI","disableDoubleClickZoom","draggable","draggableCursor","draggingCursor","fullscreenControl","fullscreenControlOptions","gestureHandling","headingInteractionEnabled","isFractionalZoomEnabled","keyboardShortcuts","mapTypeControl","mapTypeControlOptions","mapTypeId","maxZoom","minZoom","noClear","panControl","panControlOptions","restriction","rotateControl","rotateControlOptions","scaleControl","scaleControlOptions","scrollwheel","streetView","streetViewControl","streetViewControlOptions","styles","tiltInteractionEnabled","zoomControl","zoomControlOptions"]);function Pt(t,e){const n={},o=Object.keys(e);for(const s of o)wt.has(s)&&(n[s]=e[s]);St(()=>{t&&t.setOptions(n)},[n])}function ke(){var t;return((t=a.useContext(G))==null?void 0:t.status)||z.NOT_LOADED}function Nt(t,e){const{viewport:n,viewState:o}=e,s=!!n;return a.useLayoutEffect(()=>{if(!t||!o)return;const{latitude:r,longitude:i,bearing:l,pitch:c,zoom:m}=o;t.moveCamera({center:{lat:r,lng:i},heading:l,tilt:c,zoom:m+1})},[t,o]),s}function Tt(t){return!t||typeof t!="object"||!("lat"in t&&"lng"in t)?!1:Number.isFinite(t.lat)&&Number.isFinite(t.lng)}function xe(t){return Tt(t)?t:t.toJSON()}function jt(t,e,n){const o=n.center?xe(n.center):null;let s=null,r=null;o&&Number.isFinite(o.lat)&&Number.isFinite(o.lng)&&(s=o.lat,r=o.lng);const i=Number.isFinite(n.zoom)?n.zoom:null,l=Number.isFinite(n.heading)?n.heading:null,c=Number.isFinite(n.tilt)?n.tilt:null;a.useLayoutEffect(()=>{if(!t)return;const m={};let g=!1;s!==null&&r!==null&&(e.current.center.lat!==s||e.current.center.lng!==r)&&(m.center={lat:s,lng:r},g=!0),i!==null&&e.current.zoom!==i&&(m.zoom=i,g=!0),l!==null&&e.current.heading!==l&&(m.heading=l,g=!0),c!==null&&e.current.tilt!==c&&(m.tilt=c,g=!0),g&&t.moveCamera(m)})}const Rt=()=>{const t={position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:999,display:"flex",flexFlow:"column nowrap",textAlign:"center",justifyContent:"center",fontSize:".8rem",color:"rgba(0,0,0,0.6)",background:"#dddddd",padding:"1rem 1.5rem"};return k.createElement("div",{style:t},k.createElement("h2",null,"Error: AuthFailure"),k.createElement("p",null,"A problem with your API key prevents the map from rendering correctly. Please make sure the value of the ",k.createElement("code",null,"APIProvider.apiKey")," prop is correct. Check the error-message in the console for further details."))};function zt(){const[t,e]=a.useState(null),n=a.useCallback(o=>e(o),[e]);return[t,n]}function Ee(){return ke()===z.LOADED}function Ft(){const[,t]=a.useReducer(e=>e+1,0);return t}function Bt(t,e){const n=t.getCenter(),o=t.getZoom(),s=t.getHeading()||0,r=t.getTilt()||0,i=t.getBounds();(!n||!i||!Number.isFinite(o))&&console.warn("[useTrackedCameraState] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),Object.assign(e.current,{center:(n==null?void 0:n.toJSON())||{lat:0,lng:0},zoom:o||0,heading:s,tilt:r})}function Dt(t){const e=Ft(),n=a.useRef({center:{lat:0,lng:0},heading:0,tilt:0,zoom:0});return a.useEffect(()=>{if(!t)return;const o=google.maps.event.addListener(t,"bounds_changed",()=>{Bt(t,n),e()});return()=>o.remove()},[t,e]),n}const Ut=["id","defaultBounds","defaultCenter","defaultZoom","defaultHeading","defaultTilt","reuseMaps","renderingType","colorScheme"],Ht=["padding"];class K{static has(e){return this.entries[e]&&this.entries[e].length>0}static pop(e){return this.entries[e]&&this.entries[e].pop()||null}static push(e,n){this.entries[e]||(this.entries[e]=[]),this.entries[e].push(n)}}K.entries={};function Gt(t,e){const n=Ee(),[o,s]=a.useState(null),[r,i]=zt(),l=Dt(o),{id:c,defaultBounds:m,defaultCenter:g,defaultZoom:y,defaultHeading:v,defaultTilt:h,reuseMaps:d,renderingType:b,colorScheme:M}=t,C=B(t,Ut),L=t.zoom!==void 0||t.defaultZoom!==void 0,N=t.center!==void 0||t.defaultCenter!==void 0;!m&&(!L||!N)&&console.warn("<Map> component is missing configuration. You have to provide zoom and center (via the `zoom`/`defaultZoom` and `center`/`defaultCenter` props) or specify the region to show using `defaultBounds`. See https://visgl.github.io/react-google-maps/docs/api-reference/components/map#required"),!C.center&&g&&(C.center=g),!C.zoom&&Number.isFinite(y)&&(C.zoom=y),!C.heading&&Number.isFinite(v)&&(C.heading=v),!C.tilt&&Number.isFinite(h)&&(C.tilt=h);for(const _ of Object.keys(C))C[_]===void 0&&delete C[_];const A=a.useRef(void 0);return a.useEffect(()=>{if(!r||!n)return;const{addMapInstance:_,removeMapInstance:x}=e,{mapId:w}=t,j=`${w||"default"}:${b||"default"}:${M||"LIGHT"}`;let T,O;if(d&&K.has(j)?(O=K.pop(j),T=O.getDiv(),r.appendChild(T),O.setOptions(C),setTimeout(()=>O.setCenter(O.getCenter()),0)):(T=document.createElement("div"),T.style.height="100%",r.appendChild(T),O=new google.maps.Map(T,P({},C,b?{renderingType:b}:{},M?{colorScheme:M}:{}))),s(O),_(O,c),m){const{padding:D}=m,U=B(m,Ht);O.fitBounds(U,D)}else(!L||!N)&&O.fitBounds({east:180,west:-180,south:-90,north:90});if(A.current){const{mapId:D,cameraState:U}=A.current;D!==w&&O.setOptions(U)}return()=>{A.current={mapId:w,cameraState:l.current},T.remove(),d?K.push(j,O):google.maps.event.clearInstanceListeners(O),s(null),x(c)}},[r,n,c,t.mapId,t.renderingType,t.colorScheme]),[o,i,l]}const Ie=k.createContext(null),Oe=t=>{const{children:e,id:n,className:o,style:s}=t,r=a.useContext(G),i=ke();if(!r)throw new Error("<Map> can only be used inside an <ApiProvider> component.");const[l,c,m]=Gt(t,r);jt(l,m,t),Et(l,t),Pt(l,t);const g=Nt(l,t),y=!!t.controlled;a.useEffect(()=>{if(l)return g&&l.setOptions({disableDefaultUI:!0}),(g||y)&&l.setOptions({gestureHandling:"none",keyboardShortcuts:!1}),()=>{l.setOptions({gestureHandling:t.gestureHandling,keyboardShortcuts:t.keyboardShortcuts})}},[l,g,y,t.gestureHandling,t.keyboardShortcuts]);const v=t.center?xe(t.center):null;let h=null,d=null;v&&Number.isFinite(v.lat)&&Number.isFinite(v.lng)&&(h=v.lat,d=v.lng);const b=a.useMemo(()=>{var L,N,A,_,x;return{center:{lat:(L=h)!=null?L:0,lng:(N=d)!=null?N:0},zoom:(A=t.zoom)!=null?A:0,heading:(_=t.heading)!=null?_:0,tilt:(x=t.tilt)!=null?x:0}},[h,d,t.zoom,t.heading,t.tilt]);a.useLayoutEffect(()=>{if(!l||!y)return;l.moveCamera(b);const L=l.addListener("bounds_changed",()=>{l.moveCamera(b)});return()=>L.remove()},[l,y,b]);const M=a.useMemo(()=>P({width:"100%",height:"100%",position:"relative",zIndex:g?-1:0},s),[s,g]),C=a.useMemo(()=>({map:l}),[l]);return i===z.AUTH_FAILURE?k.createElement("div",{style:P({position:"relative"},o?{}:M),className:o},k.createElement(Rt,null)):k.createElement("div",P({ref:c,"data-testid":"map",style:o?void 0:M,className:o},n?{id:n}:{}),l?k.createElement(Ie.Provider,{value:C},e):null)};Oe.deckGLViewProps=!0;const pe=new Set;function Y(...t){const e=JSON.stringify(t);pe.has(e)||(pe.add(e),console.error(...t))}const _e=(t=null)=>{const e=a.useContext(G),{map:n}=a.useContext(Ie)||{};if(e===null)return Y("useMap(): failed to retrieve APIProviderContext. Make sure that the <APIProvider> component exists and that the component you are calling `useMap()` from is a sibling of the <APIProvider>."),null;const{mapInstances:o}=e;return t!==null?o[t]||null:n||o.default||null};function Zt(t){const e=Ee(),n=a.useContext(G);return a.useEffect(()=>{!e||!n||n.importLibrary(t)},[e,n,t]),(n==null?void 0:n.loadedLibraries[t])||null}function J(t,e,n){a.useEffect(()=>{if(!t||!e||!n)return;const o=google.maps.event.addListener(t,e,n);return()=>o.remove()},[t,e,n])}function q(t,e,n){a.useEffect(()=>{t&&(t[e]=n)},[t,e,n])}function he(t,e,n){a.useEffect(()=>{if(!(!t||!e||!n))return t.addEventListener(e,n),()=>t.removeEventListener(e,n)},[t,e,n])}function $t(t){return t.nodeType===Node.ELEMENT_NODE}const Ae=k.createContext(null),Jt={BOTTOM:["50%","100%"]},qt=({children:t,styles:e,className:n,anchorPoint:o})=>{const[s,r]=o??Jt.BOTTOM;let i=`-${s}`,l=`-${r}`;s.trimStart().startsWith("-")&&(i=s.substring(1)),r.trimStart().startsWith("-")&&(l=r.substring(1));const c=`translate(50%, 100%) translate(${i}, ${l})`;return k.createElement("div",{style:{transform:c}},k.createElement("div",{className:n,style:e},t))};function Kt(t){const[e,n]=a.useState(null),[o,s]=a.useState(null),r=_e(),i=Zt("marker"),{children:l,onClick:c,className:m,onMouseEnter:g,onMouseLeave:y,onDrag:v,onDragStart:h,onDragEnd:d,collisionBehavior:b,clickable:M,draggable:C,position:L,title:N,zIndex:A}=t,_=a.Children.count(l);return a.useEffect(()=>{if(!r||!i)return;const x=new i.AdvancedMarkerElement;x.map=r,n(x);let w=null;return _>0&&(w=document.createElement("div"),w.isCustomMarker=!0,x.content=w,s(w)),()=>{var j;x.map=null,(j=w)==null||j.remove(),n(null),s(null)}},[r,i,_]),a.useEffect(()=>{!e||!e.content||_>0||(e.content.className=m||"")},[e,m,_]),q(e,"position",L),q(e,"title",N??""),q(e,"zIndex",A),q(e,"collisionBehavior",b),a.useEffect(()=>{e&&(C!==void 0?e.gmpDraggable=C:v||h||d?e.gmpDraggable=!0:e.gmpDraggable=!1)},[e,C,v,d,h]),a.useEffect(()=>{if(!e)return;const x=M!==void 0||!!c||!!g||!!y;e.gmpClickable=x,x&&e!=null&&e.content&&$t(e.content)&&(e.content.style.pointerEvents="none",e.content.firstElementChild&&(e.content.firstElementChild.style.pointerEvents="all"))},[e,M,c,g,y]),J(e,"click",c),J(e,"drag",v),J(e,"dragstart",h),J(e,"dragend",d),he(e==null?void 0:e.element,"mouseenter",g),he(e==null?void 0:e.element,"mouseleave",y),[e,o]}const Vt=a.forwardRef((t,e)=>{const{children:n,style:o,className:s,anchorPoint:r}=t,[i,l]=Kt(t),c=a.useMemo(()=>i?{marker:i}:null,[i]);return a.useImperativeHandle(e,()=>i,[i]),l?k.createElement(Ae.Provider,{value:c},be.createPortal(k.createElement(qt,{anchorPoint:r,styles:o,className:s},n),l)):null});function Wt(){const[t,e]=a.useState(null);return[a.useCallback(o=>{e(o)},[]),t]}const Yt=["onClick","onDrag","onDragStart","onDragEnd","onMouseOver","onMouseOut"];function Xt(t){const[e,n]=a.useState(null),o=_e(),{onClick:s,onDrag:r,onDragStart:i,onDragEnd:l,onMouseOver:c,onMouseOut:m}=t,g=B(t,Yt),{position:y,draggable:v}=g;return a.useEffect(()=>{if(!o){o===void 0&&console.error("<Marker> has to be inside a Map component.");return}const h=new google.maps.Marker(g);return h.setMap(o),n(h),()=>{h.setMap(null),n(null)}},[o]),a.useEffect(()=>{if(!e)return;const h=e,d=google.maps.event;return s&&d.addListener(h,"click",s),r&&d.addListener(h,"drag",r),i&&d.addListener(h,"dragstart",i),l&&d.addListener(h,"dragend",l),c&&d.addListener(h,"mouseover",c),m&&d.addListener(h,"mouseout",m),e.setDraggable(!!v),()=>{d.clearInstanceListeners(h)}},[e,v,s,r,i,l,c,m]),a.useEffect(()=>{e&&g&&e.setOptions(g)},[e,g]),a.useEffect(()=>{v||!y||!e||e.setPosition(y)},[v,y,e]),e}a.forwardRef((t,e)=>{const n=Xt(t);return a.useImperativeHandle(e,()=>n,[n]),k.createElement(k.Fragment,null)});const Qt=t=>{var e;const n=(e=a.useContext(Ae))==null?void 0:e.marker,o=a.useMemo(()=>document.createElement("div"),[]);return a.useEffect(()=>{var s;if(!n){n===void 0&&console.error("The <Pin> component can only be used inside <AdvancedMarker>.");return}t.glyph&&t.children&&Y("The <Pin> component only uses children to render the glyph if both the glyph property and children are present."),a.Children.count(t.children)>1&&Y("Passing multiple children to the <Pin> component might lead to unexpected results.");const r=P({},t),i=new google.maps.marker.PinElement(r);t.children&&(i.glyph=o);const l=(s=n.content)==null||(s=s.firstChild)==null?void 0:s.firstChild;for(;l!=null&&l.firstChild;)l.removeChild(l.firstChild);l&&l.appendChild(i.element)},[n,o,t]),be.createPortal(t.children,o)},Se=({mapData:t,poi:e,markerOptions:n,isRoot:o})=>{const[s,r]=Wt(),[i,l]=a.useState(!1),[c,m]=a.useState(!1),[g,y]=a.useState(void 0);a.useEffect(()=>{},[t.userInteraction.markerInteraction.enabled,t.userInteraction.markerInteraction.style.background,c,i]);const[v,h]=a.useState(void 0);a.useEffect(()=>{},[t.userInteraction.markerInteraction.enabled,t.userInteraction.markerInteraction.style.borderColor,c,i]);const[d,b]=a.useState(void 0);a.useEffect(()=>{},[t.userInteraction.markerInteraction.enabled,t.userInteraction.markerInteraction.style.glyphColor,c,i]);const[M,C]=a.useState(0);return a.useEffect(()=>{},[t.userInteraction.markerInteraction.enabled,t.userInteraction.markerInteraction.scale,c,i]),isNaN(e.location.lat)||isNaN(e.location.lng)?null:f.jsxs(f.Fragment,{children:[f.jsx(Vt,{ref:s,title:e.title,position:{lat:Number(e.location.lat),lng:Number(e.location.lng)},onMouseEnter:()=>{t.userInteraction.markerInteraction.enabled&&m(!0)},onMouseLeave:()=>{t.userInteraction.markerInteraction.enabled&&m(!1)},onClick:()=>{l(!i)},className:"pp-marker"+(o===!0?" pp-root-marker":""),zIndex:c||i?1:void 0,children:f.jsx(Qt,{background:g,borderColor:v,glyph:n.glyph,glyphColor:d,scale:(n.scale??1)+(c||i?M:0)})},e.key),!1]})},en={background:void 0,borderColor:void 0,glyph:void 0,glyphColor:void 0,scale:void 0},we=t=>ze({},en,t),tn=({mapData:t,rows:e})=>{var o;const n=s=>we({});return((o=t==null?void 0:t.state)==null?void 0:o.locations)===void 0?null:f.jsx(f.Fragment,{children:t.state.locations.map((s,r)=>s?f.jsx(Se,{mapData:t,poi:s,markerOptions:n()},s.key):null)})},nn=t=>{const e=Ke(n=>n.maps[t]);return I.debug("mapData",e),e},rn=({appId:t,title:e,showToolBar:n,isExploring:o,isBuilderEnabled:s,appLanguage:r,elevation:i})=>{const l=Ce(),c=Xe();return f.jsx(f.Fragment,{children:n&&f.jsx(tt,{className:"pp-header",elevation:i,position:"relative",sx:{margin:"0 0 5px 0",borderRadius:"4px"},children:f.jsxs(Me,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[f.jsx(W,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:e}),f.jsxs(W,{sx:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[s&&f.jsx(ce,{title:"Map Builder",className:"pp-builder-button",children:f.jsx(de,{sx:{color:"inherit",padding:0},onClick:()=>{l(Fe({appId:t}))},children:f.jsx(nt,{})})}),o&&f.jsx(ce,{title:r.close,children:f.jsx(de,{sx:{color:"inherit",padding:0},onClick:()=>{l(Be({isActive:!1,appDbId:0})),l(De({appId:t})),c(t),l(Ue())},children:f.jsx(rt,{})})})]})]})})})},on=({mapRadius:t,setMapRadius:e,radiusUnit:n,setRadiusUnit:o,searchRadius:s})=>f.jsxs(Me,{className:"pp-map-toolbar",sx:{justifyContent:"end",alignItems:"center",gap:"12px","&.pp-map-toolbar":{paddingRight:"12px"}},children:[f.jsxs(ut,{MenuProps:{id:"pp-map-radius"},value:t,sx:{height:"40px",background:"none padding-box rgb(255, 255, 255)","& svg":{width:"40px"}},onChange:r=>{e(Number(r.target.value))},startAdornment:f.jsx(lt,{}),children:[...s.map(r=>f.jsx(ct,{value:r,children:r},r))]}),f.jsxs(dt,{value:n,exclusive:!0,onChange:(r,i)=>{i!==null&&o(i)},sx:{height:"40px",background:"none padding-box rgb(255, 255, 255)"},children:[f.jsx(fe,{value:"km",children:"KM"}),f.jsx(fe,{value:"miles",children:"Miles"})]})]}),ve=a.lazy(()=>ye(()=>import("./Alert-1.0.43-BeyiDeYu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)),an=a.lazy(()=>ye(()=>import("./Settings-1.0.43-Cn5CreJr.js"),__vite__mapDeps([15,16,1,2,3,7,8,9,10,17,18,5,6,11,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,4,34,35,36,37,38]),import.meta.url)),$n=({appId:t,mapSetup:e,tableStore:n,shortcodeArgs:o})=>{var Q,ee,te,ne,re,oe;I.debug(t,e);const s=Ce(),r=nn(t),i=Ye(t),l=Qe(t),c=Ve(),m=et,g=st(),y=at(g,Ge.table,He.form),[v,h]=a.useState([]),[d,b]=a.useState(!1),[M,C]=a.useState(r.initialLocation.static),[L,N]=a.useState({lat:void 0,lng:void 0});a.useEffect(()=>{r.initialLocation.static||(navigator.geolocation?navigator.geolocation.getCurrentPosition(p=>{p.coords===void 0?(I.error("ERROR - Could not determine user location"),$("Could not determine user location",{variant:"error"})):N({lat:p.coords.latitude,lng:p.coords.longitude}),C(!0)},p=>{I.error("ERROR - ",p),$(p.message,{variant:"error"}),C(!0)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):(I.error("Geolocation is not supported by this browser."),$("Geolocation is not supported by this browser",{variant:"error"}),C(!0)))},[]);const[A,_]=a.useState(r.userInteraction.defaultRadius),[x,w]=a.useState(r.userInteraction.distanceUnit),j=a.useMemo(()=>{var S;let p={};try{const u=JSON.parse((S=i==null?void 0:i.app)==null?void 0:S.container[0].cnt_cls);Array.isArray(u)&&u.map(E=>{E.columnName&&E.isSelected!==void 0&&(p[E.columnName]=E.isSelected)})}catch(u){I.error("Invalid JSON - map columns"),I.error(u),$("Invalid JSON, check console",{variant:"error"})}return p},[]),T=a.useMemo(()=>Ze(i),[t]);a.useEffect(()=>{M&&n===void 0&&O()},[M,A,x]);const O=async()=>{var p,S;await We($e.appUrlAppSelect,{client_side:!0,app_id:(p=i==null?void 0:i.src)==null?void 0:p.app_id,cnt_id:(S=i==null?void 0:i.src)==null?void 0:S.cnt_id,col:j,media:[],search_data_types:(()=>{const u={};return Object.keys(j).map(E=>{const R=i==null?void 0:i.columns.filter(Z=>Z.column_name===E);if(Array.isArray(R)&&R.length===1)return u[E]=R[0].data_type}),u})(),search_custom:ft(r.setup.defaultWhere),shortcode_params:o,geo_radius:r.userInteraction.enabled?(()=>{const u=X();return{col:{lat:e.columnLatitude,lng:e.columnLongitude},loc:{lat:u==null?void 0:u.lat,lng:u==null?void 0:u.lng},radius:A,unit:x}})():{}}).then(u=>{var R,Z,ie,ae,se,le,ue;I.debug(u),Array.isArray((R=u==null?void 0:u.data)==null?void 0:R.data)&&h(u.data.data);let E={};if(((ie=(Z=i==null?void 0:i.app)==null?void 0:Z.app[0])==null?void 0:ie.app_theme)!==void 0&&((se=(ae=i==null?void 0:i.app)==null?void 0:ae.app[0])==null?void 0:se.app_theme)!==null&&((ue=(le=i==null?void 0:i.app)==null?void 0:le.app[0])==null?void 0:ue.app_theme)!=="")try{E=JSON.parse(i.app.app[0].app_theme)}catch(je){I.error("Invalid JSON - theme settings"),I.error(je)}E===!1&&(E={}),I.debug(E),s(Je({appId:t,themeState:E}))}).catch(u=>{I.error(u)})},D=p=>{if(p.toLocaleUpperCase().startsWith("POINT("))return p.substring(6,p.length-1).split(" ")[0]},U=p=>{if(p.toLocaleUpperCase().startsWith("POINT("))return p.substring(6,p.length-1).split(" ")[1]};if(a.useEffect(()=>{const p=n===void 0?v:n.state.mapData;if(Array.isArray(p)){const S=p.filter(u=>u[e.columnLatitude]!==null&&u[e.columnLongitude]!==null&&(e.columnLatitude===e.columnLongitude||!isNaN(u[e.columnLatitude])&&!isNaN(u[e.columnLongitude]))).map(u=>{if(I.debug(u),e.columnLatitude===e.columnLongitude){const E=D(u[e.columnLatitude]),R=U(u[e.columnLongitude]);if(E&&R)return{key:String(u[e.columnLatitude]),location:{lat:Number(E),lng:Number(R)},title:F(r.mapMarkers.marker.title,u),header:F(r.mapMarkers.marker.header,u),content:F(r.mapMarkers.marker.content,u)}}else return{key:String(u[e.columnLatitude])+String(u[e.columnLongitude]),location:{lat:Number(u[e.columnLatitude]),lng:Number(u[e.columnLongitude])},title:F(r.mapMarkers.marker.title,u),header:F(r.mapMarkers.marker.header,u),content:F(r.mapMarkers.marker.content,u)}});s(qe({appId:t,property:{locations:S}}))}},[r.mapMarkers.marker,v,n==null?void 0:n.state.mapData]),e.columnLatitude==""||e.columnLongitude=="")return f.jsx(a.Suspense,{children:f.jsx(ve,{severity:"error",message:"Latitude and/or longitude column not defined - use App Manager to fix issue",close:!1})});if(e.apiKey==="")return f.jsx(a.Suspense,{children:f.jsx(ve,{severity:"error",message:"Missing Google Maps API Key - use App Manager to fix issue",close:!1})});const X=()=>{if(r.initialLocation.static&&!isNaN(r.initialLocation.staticMarker.location.lat)&&!isNaN(r.initialLocation.staticMarker.location.lng))return{lat:Number(r.initialLocation.staticMarker.location.lat),lng:Number(r.initialLocation.staticMarker.location.lng)};if(L.lat&&L.lng)return{lat:L.lat,lng:L.lng}},Pe=()=>we({}),Ne=()=>n!==void 0?"0":r.userInteraction.enabled?"calc(138px + 2em)":"calc(69px + 2em)",Te=a.useMemo(()=>{var p,S,u;return((u=window.PP_APP_CONFIG[(S=(p=i==null?void 0:i.app)==null?void 0:p.app[0])==null?void 0:S.app_id])==null?void 0:u.hideTitleBar)===!0},[]);return M?f.jsxs(W,{className:"pp-map",sx:{...((Q=r==null?void 0:r.setup)==null?void 0:Q.width)&&((ee=r==null?void 0:r.setup)==null?void 0:ee.widthUnit)&&((te=r==null?void 0:r.setup)==null?void 0:te.height)&&((ne=r==null?void 0:r.setup)==null?void 0:ne.heightUnit)&&{"&.pp-map":{width:r.setup.width+r.setup.widthUnit,height:r.setup.height+r.setup.heightUnit,marginBottom:Ne()}}},children:[f.jsx(me,{theme:y,children:f.jsx(xt,{apiKey:e.apiKey,onLoad:()=>{I.debug("Google Maps API has loaded..."),b(!0)},onError:p=>{I.error(p),I.error("Make sure your Google Maps API key is correctly entered in the App Manager and correctly defined in your Google Cloud Platform Console.")},children:d&&f.jsxs(f.Fragment,{children:[n===void 0&&Te!==!0&&f.jsx(rn,{appId:t,title:((oe=(re=i==null?void 0:i.app)==null?void 0:re.app[0])==null?void 0:oe.app_title)??"Map Builder",showToolBar:!0,isExploring:(i==null?void 0:i.isExploring)===!0,isBuilderEnabled:T,appLanguage:m,elevation:4}),r.userInteraction.enabled&&f.jsx(on,{mapRadius:A,setMapRadius:_,radiusUnit:x,setRadiusUnit:w,searchRadius:r.userInteraction.searchRadius}),f.jsxs(Oe,{mapId:t,mapTypeId:r.setup.startMode,fullscreenControl:l==null?void 0:l.allowFullScreen,defaultCenter:X(),defaultZoom:r.setup.initialZoom,gestureHandling:r.setup.gestureHandling,disableDefaultUI:!r.setup.googleMapsButtons,style:{width:"100%",height:"100%"},children:[r.initialLocation.showStaticMarker&&(r.initialLocation.static||L.lat!==void 0&&L.lng!==void 0)&&f.jsx(Se,{mapData:r,poi:r.initialLocation.static?r.initialLocation.staticMarker:{key:"user-location",location:{lat:L.lat??0,lng:L.lng??0},title:r.initialLocation.staticMarker.title,header:r.initialLocation.staticMarker.header,content:r.initialLocation.staticMarker.content},markerOptions:Pe(),isRoot:!0}),f.jsx(tn,{mapData:r,rows:v})]})]})})}),T&&f.jsx(a.Suspense,{fallback:f.jsx(ot,{}),children:f.jsx(me,{theme:c,children:f.jsx(an,{appId:t})})})]}):f.jsx(it,{})};export{$n as default};
