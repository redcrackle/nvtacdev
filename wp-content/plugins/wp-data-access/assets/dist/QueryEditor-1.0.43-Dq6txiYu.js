const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CodeField-1.0.43-BUmVyqpR.js","./cm-1.0.43-BIThoEwM.js","./redux-1.0.43-X9ShETON.js","./vendor-1.0.43-CN03Eozo.js","./index-1.0.43-Br_nYvvF.js","./iconBase-1.0.43-BkINToSh.js","./Typography-1.0.43-CjHjtdZs.js","./lib-1.0.43-GM4CAPbj.js","./loglevel-1.0.43-BZ7XahX3.js","./lodash-1.0.43-BGoSrRk7.js","./moment-1.0.43-C5S46NFB.js","./useEnhancedEffect-1.0.43-DcXwKdLb.js","./notistack-1.0.43-CFZ1B9cW.js","./ConfirmDialog-1.0.43-HyVPTU5U.js","./AdminTheme-1.0.43-CqjS-p3h.js","./Spinner-1.0.43-YmZqinVQ.js","./FormControlLabel-1.0.43-DhLqIzQC.js","./useFormControl-1.0.43-D7bmEJOO.js","./Switch-1.0.43-DUXi6nEm.js","./SwitchBase-1.0.43-jxlYBoq8.js","./useControlled-1.0.43-DObA-A1B.js"])))=>i.map(i=>d[i]);
import{_ as v}from"./main-1.0.43.js";import{j as u}from"./cm-1.0.43-BIThoEwM.js";import{r as p}from"./redux-1.0.43-X9ShETON.js";import{l as n,o as x}from"./lib-1.0.43-GM4CAPbj.js";import{a as S}from"./hooks-1.0.43-Bzf6s8gj.js";import{l as H,u as l,k as _,f as b,g as E}from"./StartQueryBuilder-1.0.43-DFJvLNPB.js";import{e as I,u as j,a as B}from"./QueryBuilder-1.0.43-DowaLN4B.js";import{u as g}from"./MainQueryBuilder-1.0.43-Bpy4iomZ.js";import{e as f}from"./notistack-1.0.43-CFZ1B9cW.js";import{B as k}from"./Spinner-1.0.43-YmZqinVQ.js";import"./vendor-1.0.43-CN03Eozo.js";import"./loglevel-1.0.43-BZ7XahX3.js";import"./lodash-1.0.43-BGoSrRk7.js";import"./moment-1.0.43-C5S46NFB.js";import"./index-1.0.43-Br_nYvvF.js";import"./iconBase-1.0.43-BkINToSh.js";import"./Typography-1.0.43-CjHjtdZs.js";import"./useEnhancedEffect-1.0.43-DcXwKdLb.js";import"./ConfirmDialog-1.0.43-HyVPTU5U.js";import"./AdminTheme-1.0.43-CqjS-p3h.js";import"./RestApi-1.0.43-DDknciaN.js";import"./index-1.0.43-DuBV8iHb.js";import"./index-1.0.43-DTrIm2Pv.js";import"./index-1.0.43-Lwi8RVeB.js";import"./SanitizeComponent-1.0.43-DS8pdFaO.js";import"./dompurify-1.0.43-DhD2mIk-.js";import"./FormHelperText-1.0.43-BbvxPfFT.js";import"./utils-1.0.43-iop7lDec.js";import"./useFormControl-1.0.43-D7bmEJOO.js";import"./FormControlLabel-1.0.43-DhLqIzQC.js";import"./Checkbox-1.0.43-C_H-ygma.js";import"./SwitchBase-1.0.43-jxlYBoq8.js";import"./useControlled-1.0.43-DObA-A1B.js";import"./createSvgIcon-1.0.43-C8_lU5Lv.js";import"./Tooltip-1.0.43-Dw3sfo8K.js";import"./ThemeProvider-1.0.43-BdkGbeAu.js";import"./Popper-1.0.43-8Yb3KIgh.js";import"./Menu-1.0.43-TbmZ3Ge2.js";import"./Divider-1.0.43-BNePHRrN.js";import"./MenuItem-1.0.43-Uicrp-o6.js";import"./TextField-1.0.43-DsZQBbKY.js";import"./Select-1.0.43-CISjJoqC.js";import"./FormLabel-1.0.43-DuYrsDLO.js";import"./InputAdornment-1.0.43-9P5bF1dN.js";import"./TabPanel-1.0.43-BFjnBi0G.js";import"./useThemeProps-1.0.43-C5lTKcwO.js";import"./getThemeProps-1.0.43-5uxEwZ_e.js";import"./TabList-1.0.43-wevj3JyD.js";import"./Tabs-1.0.43-C3a4iH_4.js";import"./Switch-1.0.43-DUXi6nEm.js";/* empty css                    */import"./ActionsExplorer-1.0.43-BvdT5anO.js";import"./DatabaseTypeEnum-1.0.43-DeJfpW1u.js";const C=()=>{const e=S(),r=g();return o=>{const s=r.queries[r.tabIndex];r.sqlSchemas[s==null?void 0:s.schemaName]===void 0&&I(o,i=>{n.debug(i),(i==null?void 0:i.code)==="ok"&&e(H({sqlSchemaName:o,sqlSchema:i==null?void 0:i.data}))},i=>{n.error(i)})}},R=p.lazy(()=>v(()=>import("./CodeField-1.0.43-BUmVyqpR.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),import.meta.url)),Re=({queryKey:e,query:r,fullScreen:d})=>{const o=S(),s=g(),i=C(),{getQueryKey:Q}=j(),[h,q]=p.useState(x(r.query)),a=p.useRef();a.current=h,p.useEffect(()=>{s.showSqlHints&&i(s.queries[e].schemaName)},[s.showSqlHints,s.queries[e].schemaName]),p.useEffect(()=>{s.copyQuery&&(q(s.copyQuery),o(l({queryKey:e,query:{access:r.access,queryName:r.queryName,query:s.copyQuery,schemaName:r.schemaName,isVisual:r.isVisual,isInserting:r.isInserting,params:r.params}})),o(_({copyQuery:void 0})))},[s.copyQuery]);const N=()=>{var c;if(a.current){const t=b.getSelectors().selectQueryBuilder(E.getState().sql);(c=t==null?void 0:t.queries)!=null&&c[e]&&B(t.queries[e].access,t.queries[e].schemaName,t.queries[e].queryName,x(a.current),!1,"",t.queries[e].isInserting,t.queries[e].params,m=>{n.debug(m),(m==null?void 0:m.code)==="ok"&&(o(l({queryKey:e,query:{...t.queries[e],isInserting:void 0},isUpdated:!1})),f("Query succesfully saved",{variant:"success"}))},m=>{n.error(m),f(m,{variant:"error"})})}else f("Invalid code reference",{variant:"error"})};return u.jsx(k,{className:"pp-sql-query-builder-editor",children:u.jsx(p.Suspense,{children:u.jsx(R,{code:h,setCode:c=>{q(c),o(l({queryKey:e,query:{...r,query:c}}))},dialogTitle:Q(e),extension:"sql",sqlSchema:s.showSqlHints?s.sqlSchemas[s.queries[e].schemaName]:void 0,initialHeight:d?"calc(((100vh - 69px - 48px - 69px - 48px - 5px) / 2) - 28px - 5px)":"270px",saveCode:N})})})};export{Re as default};
